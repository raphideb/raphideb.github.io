<!DOCTYPE html>
<html
  lang="en"
  class="color-toggle-hidden"
  
>
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8" />
<meta name="referrer" content="no-referrer" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="color-scheme" content="light dark" />
<meta name="generator" content="Hugo 0.147.9">


  <meta name="description" content=" ashtop - the Swiss Army Knife for ASH Table of content ashtop - the Swiss Army Knife for ASH Syntax Structure of ashtop Time specifications Derived columns username and objt event2 time_model_name Meaning of some of the time_model_name Empty SQL_ID Formatting Customizing ashtop.sql Working with a copy of the ASH Using ashtop Example queries Top events of the last hour Top waits of the last 5 minutes Sessions with highest CPU usage Sessions with the highest I/O waits What was the application doing What was a specific session doing Which waits on which objects Which SQL statement read the longest from what What caused the most log file syncs Are top sessions blocked by another session Top blocked sessions On which objects blocked sessions each other Highest PGA usage SQL plan statistics With ashtop With asqlmon Conclusion Tanel Poder&rsquo;s script &ldquo;ashtop.sql&rdquo; greatly simplifies querying ASH and is essentially a fully parameterizable &ldquo;grep&rdquo; for ASH. The script comes in two variants:" />

    <title>ashtop | raphi&#39;s corner</title>

    <link rel="icon" type="image/svg+xml" href="/favicon/favicon.svg" />
<link
  rel="icon"
  type="image/png"
  sizes="32x32"
  href="/favicon/favicon-32x32.png"
/>
<link
  rel="icon"
  type="image/png"
  sizes="16x16"
  href="/favicon/favicon-16x16.png"
/>

    

    
  <meta
    property="og:title"
    content="ashtop"
  />
  <meta property="og:site_name" content="raphi's corner" />
  <meta property="og:description" content=" ashtop - the Swiss Army Knife for ASH Table of content ashtop - the Swiss Army Knife for ASH Syntax Structure of ashtop Time specifications Derived columns username and objt event2 time_model_name Meaning of some of the time_model_name Empty SQL_ID Formatting Customizing ashtop.sql Working with a copy of the ASH Using ashtop Example queries Top events of the last hour Top waits of the last 5 minutes Sessions with highest CPU usage Sessions with the highest I/O waits What was the application doing What was a specific session doing Which waits on which objects Which SQL statement read the longest from what What caused the most log file syncs Are top sessions blocked by another session Top blocked sessions On which objects blocked sessions each other Highest PGA usage SQL plan statistics With ashtop With asqlmon Conclusion Tanel Poder’s script “ashtop.sql” greatly simplifies querying ASH and is essentially a fully parameterizable “grep” for ASH. The script comes in two variants:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/oracle/ashtop/" />

<meta property="article:section" content="Oracle" />


  <meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="ashtop" />
  <meta name="twitter:description" content=" ashtop - the Swiss Army Knife for ASH Table of content ashtop - the Swiss Army Knife for ASH Syntax Structure of ashtop Time specifications Derived columns username and objt event2 time_model_name Meaning of some of the time_model_name Empty SQL_ID Formatting Customizing ashtop.sql Working with a copy of the ASH Using ashtop Example queries Top events of the last hour Top waits of the last 5 minutes Sessions with highest CPU usage Sessions with the highest I/O waits What was the application doing What was a specific session doing Which waits on which objects Which SQL statement read the longest from what What caused the most log file syncs Are top sessions blocked by another session Top blocked sessions On which objects blocked sessions each other Highest PGA usage SQL plan statistics With ashtop With asqlmon Conclusion Tanel Poder’s script “ashtop.sql” greatly simplifies querying ASH and is essentially a fully parameterizable “grep” for ASH. The script comes in two variants:" />


  <script type="application/ld+json">
  {
      "@context": "http://schema.org",
      "@type": "TechArticle",
      "articleSection": "Oracle",
      "name": "ashtop",
      "url" : "http://localhost:1313/oracle/ashtop/",
      "headline": "ashtop",
      "description": " ashtop - the Swiss Army Knife for ASH Table of content ashtop - the Swiss Army Knife for ASH Syntax Structure of ashtop Time specifications Derived columns username and objt event2 time_model_name Meaning of some of the time_model_name Empty SQL_ID Formatting Customizing ashtop.sql Working with a copy of the ASH Using ashtop Example queries Top events of the last hour Top waits of the last 5 minutes Sessions with highest CPU usage Sessions with the highest I\/O waits What was the application doing What was a specific session doing Which waits on which objects Which SQL statement read the longest from what What caused the most log file syncs Are top sessions blocked by another session Top blocked sessions On which objects blocked sessions each other Highest PGA usage SQL plan statistics With ashtop With asqlmon Conclusion Tanel Poder’s script “ashtop.sql” greatly simplifies querying ASH and is essentially a fully parameterizable “grep” for ASH. The script comes in two variants:",
      "wordCount" : "2223",
      "inLanguage": "en",
      "isFamilyFriendly": "true",
      "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "http://localhost:1313/oracle/ashtop/"
      },
      "copyrightHolder" : "raphi\u0027s corner",
      "copyrightYear" : "0001",
      "dateCreated": "0001-01-01T00:00:00.00Z",
      "datePublished": "0001-01-01T00:00:00.00Z",
      "dateModified": "0001-01-01T00:00:00.00Z",
      "publisher":{
          "@type":"Organization",
          "name": "raphi's corner",
          "url": "http://localhost:1313/",
          "logo": {
              "@type": "ImageObject",
              "url": "http://localhost:1313/brand.svg",
              "width":"32",
              "height":"32"
          }
      }
  }
  </script>


    
  <script src="/js/colortheme-05deda6f.bundle.min.js"></script>
<script src="/js/main-c5dd8165.bundle.min.js"></script>

<link
  rel="preload"
  as="font"
  href="/fonts/Metropolis.woff2"
  type="font/woff2"
  crossorigin="anonymous"
/>
<link
  rel="preload"
  as="font"
  href="/fonts/LiberationSans.woff2"
  type="font/woff2"
  crossorigin="anonymous"
/>

<link
  rel="preload"
  href="/main-b53472e8.min.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/main-b53472e8.min.css"
  media="all"
/>

<link
  rel="preload"
  href="/mobile-7885c8a8.min.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/mobile-7885c8a8.min.css"
  media="screen and (max-width: 45rem)"
/>

<link
  rel="preload"
  href="/print-72068949.min.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/print-72068949.min.css"
  media="print"
/>

<link
  rel="preload"
  href="/custom.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/custom.css"
  media="all"
/>
  <link href="http://localhost:1313/oracle/ashtop/" rel="canonical" type="text/html" />

<!-- Made with Geekdoc theme https://github.com/thegeeklab/hugo-geekdoc -->

    <link rel="stylesheet" type="text/css" href="/css/custom.css" />

  </head>

  <body itemscope itemtype="https://schema.org/WebPage">
    <div class="w-full flex justify-center">
      <a href="#main-content" id="gdoc-to-main" class="gdoc-markdown__link">Skip to main content</a>
    </div>

    
  <!-- geekdoc include: /sprites/geekdoc.svg -->
  <svg class="svg-sprite" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_arrow_back" xmlns="http://www.w3.org/2000/svg"><path d="M24 10.526v2.947H5.755l8.351 8.421-2.105 2.105-12-12 12-12 2.105 2.105-8.351 8.421H24z"/></svg><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_arrow_left_alt" xmlns="http://www.w3.org/2000/svg"><path d="M5.965 10.526V6.035L0 12l5.965 5.965v-4.491H24v-2.947H5.965z"/></svg><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_arrow_right_alt" xmlns="http://www.w3.org/2000/svg"><path d="M18.035 10.526V6.035L24 12l-5.965 5.965v-4.491H0v-2.947h18.035z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_bitbucket" xmlns="http://www.w3.org/2000/svg"><path d="M15.905 13.355c.189 1.444-1.564 2.578-2.784 1.839-1.375-.602-1.375-2.784-.034-3.403 1.151-.705 2.818.223 2.818 1.564zm1.907-.361c-.309-2.44-3.076-4.056-5.328-3.042-1.426.636-2.389 2.148-2.32 3.747.086 2.097 2.08 3.815 4.176 3.626s3.729-2.234 3.472-4.331zm4.108-9.315c-.756-.997-2.045-1.169-3.179-1.358-3.214-.516-6.513-.533-9.727.034-1.066.172-2.269.361-2.939 1.323 1.1 1.031 2.664 1.186 4.073 1.358 2.544.327 5.156.344 7.699.017 1.426-.172 3.008-.309 4.073-1.375zm.979 17.788c-.481 1.684-.206 3.953-1.994 4.932-3.076 1.701-6.806 1.89-10.191 1.289-1.787-.327-3.884-.894-4.864-2.578-.43-1.65-.705-3.334-.98-5.018l.103-.275.309-.155c5.121 3.386 12.288 3.386 17.427 0 .808.241.206 1.22.189 1.805zM26.01 4.951c-.584 3.764-1.255 7.51-1.908 11.257-.189 1.1-1.255 1.719-2.148 2.183-3.214 1.615-6.96 1.89-10.483 1.512-2.389-.258-4.829-.894-6.771-2.389-.911-.705-.911-1.908-1.083-2.922-.602-3.523-1.289-7.046-1.719-10.604.206-1.547 1.942-2.217 3.231-2.698C6.848.654 8.686.362 10.508.19c3.884-.378 7.854-.241 11.618.859 1.341.395 2.784.945 3.695 2.097.412.533.275 1.203.189 1.805z"/></svg><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_bookmark" xmlns="http://www.w3.org/2000/svg"><path d="M15.268 4.392q.868 0 1.532.638t.664 1.506v17.463l-7.659-3.268-7.608 3.268V6.536q0-.868.664-1.506t1.532-.638h10.876zm4.34 14.144V4.392q0-.868-.638-1.532t-1.506-.664H6.537q0-.868.664-1.532T8.733 0h10.876q.868 0 1.532.664t.664 1.532v17.412z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_brightness_auto" xmlns="http://www.w3.org/2000/svg"><path d="M16.846 18.938h2.382L15.22 7.785h-2.44L8.772 18.938h2.382l.871-2.44h3.95zm7.087-9.062L27.999 14l-4.066 4.124v5.809h-5.809L14 27.999l-4.124-4.066H4.067v-5.809L.001 14l4.066-4.124V4.067h5.809L14 .001l4.124 4.066h5.809v5.809zm-11.385 4.937L14 10.282l1.452 4.531h-2.904z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_brightness_dark" xmlns="http://www.w3.org/2000/svg"><path d="M14 21.435q3.079 0 5.257-2.178T21.435 14t-2.178-5.257T14 6.565q-1.51 0-3.079.697 1.917.871 3.108 2.701T15.22 14t-1.191 4.037-3.108 2.701q1.568.697 3.079.697zm9.933-11.559L27.999 14l-4.066 4.124v5.809h-5.809L14 27.999l-4.124-4.066H4.067v-5.809L.001 14l4.066-4.124V4.067h5.809L14 .001l4.124 4.066h5.809v5.809z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_brightness_light" xmlns="http://www.w3.org/2000/svg"><path d="M14 21.435q3.079 0 5.257-2.178T21.435 14t-2.178-5.257T14 6.565 8.743 8.743 6.565 14t2.178 5.257T14 21.435zm9.933-3.311v5.809h-5.809L14 27.999l-4.124-4.066H4.067v-5.809L.001 14l4.066-4.124V4.067h5.809L14 .001l4.124 4.066h5.809v5.809L27.999 14z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_check" xmlns="http://www.w3.org/2000/svg"><path d="M8.885 20.197 25.759 3.323l2.24 2.24L8.885 24.677 0 15.792l2.24-2.24z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_check_circle_outline" xmlns="http://www.w3.org/2000/svg"><path d="M14 25.239q4.601 0 7.92-3.319T25.239 14 21.92 6.08 14 2.761 6.08 6.08 2.761 14t3.319 7.92T14 25.239zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0zm6.441 7.822 1.972 1.972-11.239 11.239L4.207 14l1.972-1.972 4.995 4.995z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_cloud_off" xmlns="http://www.w3.org/2000/svg"><path d="M9.023 10.5H7q-1.914 0-3.281 1.395t-1.367 3.309 1.367 3.281T7 19.852h11.375zM3.5 4.976l1.477-1.477L24.5 23.022l-1.477 1.477-2.352-2.297H6.999q-2.898 0-4.949-2.051t-2.051-4.949q0-2.844 1.969-4.867t4.758-2.133zm19.086 5.578q2.242.164 3.828 1.832T28 16.351q0 3.008-2.461 4.758l-1.695-1.695q1.805-.984 1.805-3.063 0-1.422-1.039-2.461t-2.461-1.039h-1.75v-.602q0-2.68-1.859-4.539t-4.539-1.859q-1.531 0-2.953.711l-1.75-1.695Q11.431 3.5 14.001 3.5q2.953 0 5.496 2.078t3.09 4.977z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_code" xmlns="http://www.w3.org/2000/svg"><path d="M9.917 24.5a1.75 1.75 0 1 0-3.501.001 1.75 1.75 0 0 0 3.501-.001zm0-21a1.75 1.75 0 1 0-3.501.001A1.75 1.75 0 0 0 9.917 3.5zm11.666 2.333a1.75 1.75 0 1 0-3.501.001 1.75 1.75 0 0 0 3.501-.001zm1.75 0a3.502 3.502 0 0 1-1.75 3.026c-.055 6.581-4.721 8.039-7.82 9.023-2.898.911-3.846 1.349-3.846 3.117v.474a3.502 3.502 0 0 1 1.75 3.026c0 1.932-1.568 3.5-3.5 3.5s-3.5-1.568-3.5-3.5c0-1.294.711-2.424 1.75-3.026V6.526A3.502 3.502 0 0 1 4.667 3.5c0-1.932 1.568-3.5 3.5-3.5s3.5 1.568 3.5 3.5a3.502 3.502 0 0 1-1.75 3.026v9.06c.93-.456 1.914-.766 2.807-1.039 3.391-1.075 5.323-1.878 5.359-5.687a3.502 3.502 0 0 1-1.75-3.026c0-1.932 1.568-3.5 3.5-3.5s3.5 1.568 3.5 3.5z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_copy" xmlns="http://www.w3.org/2000/svg"><path d="M23.502 25.438V7.626H9.562v17.812h13.94zm0-20.315q1.013 0 1.787.745t.774 1.757v17.812q0 1.013-.774 1.787t-1.787.774H9.562q-1.013 0-1.787-.774t-.774-1.787V7.625q0-1.013.774-1.757t1.787-.745h13.94zM19.689 0v2.562H4.438v17.812H1.936V2.562q0-1.013.745-1.787T4.438.001h15.251z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_dangerous" xmlns="http://www.w3.org/2000/svg"><path d="M21.802 19.833 15.969 14l5.833-5.833-1.969-1.969L14 12.031 8.167 6.198 6.198 8.167 12.031 14l-5.833 5.833 1.969 1.969L14 15.969l5.833 5.833zM19.833 0 28 8.167v11.666L19.833 28H8.167L0 19.833V8.167L8.167 0h11.666z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_date" xmlns="http://www.w3.org/2000/svg"><path d="M27.192 28.844V11.192H4.808v17.652h22.384zm0-25.689q1.277 0 2.253.976t.976 2.253v22.459q0 1.277-.976 2.216t-2.253.939H4.808q-1.352 0-2.291-.901t-.939-2.253V6.385q0-1.277.939-2.253t2.291-.976h1.577V.001h3.23v3.155h12.769V.001h3.23v3.155h1.577zm-3.155 11.267v3.155h-3.23v-3.155h3.23zm-6.46 0v3.155h-3.155v-3.155h3.155zm-6.384 0v3.155h-3.23v-3.155h3.23z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_download" xmlns="http://www.w3.org/2000/svg"><path d="M2.866 28.209h26.269v3.79H2.866v-3.79zm26.268-16.925L16 24.418 2.866 11.284h7.493V.001h11.283v11.283h7.493z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_email" xmlns="http://www.w3.org/2000/svg"><path d="M28.845 9.615v-3.23L16 14.422 3.155 6.385v3.23L16 17.577zm0-6.46q1.277 0 2.216.977T32 6.385v19.23q0 1.277-.939 2.253t-2.216.977H3.155q-1.277 0-2.216-.977T0 25.615V6.385q0-1.277.939-2.253t2.216-.977h25.69z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_error_outline" xmlns="http://www.w3.org/2000/svg"><path d="M14 25.239q4.601 0 7.92-3.319T25.239 14 21.92 6.08 14 2.761 6.08 6.08 2.761 14t3.319 7.92T14 25.239zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0zm-1.38 6.967h2.761v8.413H12.62V6.967zm0 11.239h2.761v2.826H12.62v-2.826z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_fire" xmlns="http://www.w3.org/2000/svg"><path d="M17.689 21.998q-.32.32-.8.576t-.864.384q-1.152.384-2.272.032t-1.888-.992q-.128-.128-.096-.256t.16-.192q1.216-.384 1.92-1.216t.96-1.792q.192-.896-.064-1.728t-.384-1.728q-.128-.704-.096-1.376t.288-1.312q0-.128.128-.128t.192.064q.384.832.992 1.472t1.28 1.216 1.216 1.248.672 1.568q.064.384.064.704.064.96-.32 1.92t-1.088 1.536zm3.84-10.944q-.768-.704-1.6-1.28t-1.6-1.344q-1.536-1.536-2.016-3.584t.16-4.16q.128-.32-.096-.544t-.544-.096q-.768.32-1.44.768t-1.312.896q-1.984 1.664-3.136 3.936T8.633 10.51t.8 5.088q0 .128.032.256t.032.256q0 .576-.512.832t-1.024-.192q-.128-.192-.192-.32-1.024-1.28-1.376-2.912t-.096-3.232q.064-.384-.288-.576t-.608.128q-1.28 1.664-1.856 3.68t-.448 4.064q0 .576.096 1.184t.288 1.184q.448 1.536 1.216 2.816 1.216 2.048 3.264 3.424t4.416 1.696q2.496.32 5.024-.256t4.448-2.304q1.408-1.344 2.208-3.104t.864-3.68-.704-3.712q-.064-.128-.096-.224t-.096-.224q-.576-1.088-1.28-1.984-.256-.384-.544-.704t-.672-.64z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_git" xmlns="http://www.w3.org/2000/svg"><path d="M27.472 12.753 15.247.529a1.803 1.803 0 0 0-2.55 0l-2.84 2.84 2.137 2.137a2.625 2.625 0 0 1 3.501 3.501l3.499 3.499a2.625 2.625 0 1 1-1.237 1.237l-3.499-3.499c-.083.04-.169.075-.257.106v7.3a2.626 2.626 0 1 1-1.75 0v-7.3a2.626 2.626 0 0 1-1.494-3.607L8.62 4.606l-8.09 8.09a1.805 1.805 0 0 0 0 2.551l12.225 12.224a1.803 1.803 0 0 0 2.55 0l12.168-12.168a1.805 1.805 0 0 0 0-2.551z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_gitea" xmlns="http://www.w3.org/2000/svg"><path d="M5.581 7.229c-2.46-.005-5.755 1.559-5.573 5.48.284 6.125 6.56 6.693 9.068 6.743.275 1.149 3.227 5.112 5.412 5.32h9.573c5.741-.381 10.04-17.363 6.853-17.427-5.271.248-8.395.373-11.073.395v5.3l-.835-.369-.005-4.928c-3.075-.001-5.781-.144-10.919-.397-.643-.004-1.539-.113-2.501-.116zm.348 2.166h.293c.349 3.14.917 4.976 2.067 7.781-2.933-.347-5.429-1.199-5.888-4.38-.237-1.647.563-3.365 3.528-3.401zm11.409 3.087c.2.003.404.04.596.128l.999.431-.716 1.305h-.007a.996.996 0 0 0-.321.053l.006-.002c-.349.114-.593.406-.593.749 0 .097.019.189.055.275l-.002-.006a.767.767 0 0 0 .151.233l-.001-.001-1.235 2.248a.99.99 0 0 0-.302.052l.006-.002c-.349.114-.593.406-.593.749 0 .097.019.189.055.275l-.002-.006c.128.31.457.527.843.527a.987.987 0 0 0 .31-.049l-.006.002c.348-.114.592-.406.592-.749 0-.097-.02-.19-.056-.277l.002.006a.784.784 0 0 0-.211-.293l1.203-2.189a.999.999 0 0 0 .397-.041l-.006.002a.942.942 0 0 0 .285-.15l-.001.001c.464.195.844.353 1.117.488.411.203.556.337.6.487.044.147-.004.429-.236.925-.173.369-.46.893-.799 1.511h-.02a.991.991 0 0 0-.321.053l.006-.002c-.349.114-.593.406-.593.749 0 .097.019.189.055.275l-.002-.006c.128.31.457.527.843.527a.987.987 0 0 0 .31-.049l-.006.002c.348-.114.592-.406.592-.749a.703.703 0 0 0-.055-.275l.002.006a.802.802 0 0 0-.183-.27l.001.001c.335-.611.623-1.136.808-1.531.251-.536.381-.935.267-1.32s-.467-.636-.933-.867c-.307-.151-.689-.311-1.147-.503a.723.723 0 0 0-.052-.324l.002.006a.792.792 0 0 0-.194-.279l.704-1.284 3.899 1.684c.704.305.995 1.053.653 1.68l-2.68 4.907c-.343.625-1.184.884-1.888.58l-5.516-2.384c-.704-.304-.996-1.053-.653-1.68l2.68-4.905c.235-.431.707-.687 1.207-.707z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_github" xmlns="http://www.w3.org/2000/svg"><path d="M16 .394c8.833 0 15.999 7.166 15.999 15.999 0 7.062-4.583 13.062-10.937 15.187-.813.146-1.104-.354-1.104-.771 0-.521.021-2.25.021-4.396 0-1.5-.5-2.458-1.083-2.958 3.562-.396 7.312-1.75 7.312-7.896 0-1.75-.625-3.167-1.646-4.291.167-.417.708-2.042-.167-4.25-1.333-.417-4.396 1.646-4.396 1.646a15.032 15.032 0 0 0-8 0S8.937 6.602 7.603 7.018c-.875 2.208-.333 3.833-.167 4.25-1.021 1.125-1.646 2.542-1.646 4.291 0 6.125 3.729 7.5 7.291 7.896-.458.417-.875 1.125-1.021 2.146-.917.417-3.25 1.125-4.646-1.333-.875-1.521-2.458-1.646-2.458-1.646-1.562-.021-.104.979-.104.979 1.042.479 1.771 2.333 1.771 2.333.938 2.854 5.396 1.896 5.396 1.896 0 1.333.021 2.583.021 2.979 0 .417-.292.917-1.104.771C4.582 29.455-.001 23.455-.001 16.393-.001 7.56 7.165.394 15.998.394zM6.063 23.372c.042-.083-.021-.187-.146-.25-.125-.042-.229-.021-.271.042-.042.083.021.187.146.25.104.062.229.042.271-.042zm.646.709c.083-.062.062-.208-.042-.333-.104-.104-.25-.146-.333-.062-.083.062-.062.208.042.333.104.104.25.146.333.062zm.625.937c.104-.083.104-.25 0-.396-.083-.146-.25-.208-.354-.125-.104.062-.104.229 0 .375s.271.208.354.146zm.875.875c.083-.083.042-.271-.083-.396-.146-.146-.333-.167-.417-.062-.104.083-.062.271.083.396.146.146.333.167.417.062zm1.187.521c.042-.125-.083-.271-.271-.333-.167-.042-.354.021-.396.146s.083.271.271.312c.167.062.354 0 .396-.125zm1.313.104c0-.146-.167-.25-.354-.229-.187 0-.333.104-.333.229 0 .146.146.25.354.229.187 0 .333-.104.333-.229zm1.208-.208c-.021-.125-.187-.208-.375-.187-.187.042-.312.167-.292.312.021.125.187.208.375.167s.312-.167.292-.292z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_gitlab" xmlns="http://www.w3.org/2000/svg"><path d="M1.629 11.034 14 26.888.442 17.048a1.09 1.09 0 0 1-.39-1.203l1.578-4.811zm7.217 0h10.309l-5.154 15.854zM5.753 1.475l3.093 9.559H1.63l3.093-9.559a.548.548 0 0 1 1.031 0zm20.618 9.559 1.578 4.811c.141.437-.016.922-.39 1.203l-13.558 9.84 12.371-15.854zm0 0h-7.216l3.093-9.559a.548.548 0 0 1 1.031 0z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_heart" xmlns="http://www.w3.org/2000/svg"><path d="M16 29.714a1.11 1.11 0 0 1-.786-.321L4.072 18.643c-.143-.125-4.071-3.714-4.071-8 0-5.232 3.196-8.357 8.535-8.357 3.125 0 6.053 2.464 7.464 3.857 1.411-1.393 4.339-3.857 7.464-3.857 5.339 0 8.535 3.125 8.535 8.357 0 4.286-3.928 7.875-4.089 8.035L16.785 29.392c-.214.214-.5.321-.786.321z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_home" xmlns="http://www.w3.org/2000/svg"><path d="M24.003 15.695v8.336c0 .608-.504 1.111-1.111 1.111h-6.669v-6.669h-4.446v6.669H5.108a1.119 1.119 0 0 1-1.111-1.111v-8.336c0-.035.017-.069.017-.104L14 7.359l9.986 8.232a.224.224 0 0 1 .017.104zm3.873-1.198-1.077 1.285a.578.578 0 0 1-.365.191h-.052a.547.547 0 0 1-.365-.122L14 5.831 1.983 15.851a.594.594 0 0 1-.417.122.578.578 0 0 1-.365-.191L.124 14.497a.57.57 0 0 1 .069-.781L12.679 3.314c.729-.608 1.91-.608 2.64 0l4.237 3.543V3.471c0-.313.243-.556.556-.556h3.334c.313 0 .556.243.556.556v7.085l3.803 3.161c.226.191.26.556.069.781z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_info_outline" xmlns="http://www.w3.org/2000/svg"><path d="M12.62 9.793V6.967h2.761v2.826H12.62zM14 25.239q4.601 0 7.92-3.319T25.239 14 21.92 6.08 14 2.761 6.08 6.08 2.761 14t3.319 7.92T14 25.239zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0zm-1.38 21.033V12.62h2.761v8.413H12.62z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_keyboard_arrow_down" xmlns="http://www.w3.org/2000/svg"><path d="M3.281 5.36 14 16.079 24.719 5.36 28 8.641l-14 14-14-14z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_keyboard_arrow_left" xmlns="http://www.w3.org/2000/svg"><path d="M25.875 28.25 22.125 32 6.126 16.001 22.125.002l3.75 3.75-12.25 12.25z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_keyboard_arrow_right" xmlns="http://www.w3.org/2000/svg"><path d="M6.125 28.25 18.375 16 6.125 3.75 9.875 0l15.999 15.999L9.875 31.998z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_keyboard_arrow_up" xmlns="http://www.w3.org/2000/svg"><path d="M24.719 22.64 14 11.921 3.281 22.64 0 19.359l14-14 14 14z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_language" xmlns="http://www.w3.org/2000/svg"><path d="M20.112 16.826h4.732q.394-1.84.394-2.826t-.394-2.826h-4.732q.197 1.38.197 2.826t-.197 2.826zm-2.497 7.756q1.643-.526 3.418-2.005t2.695-2.991h-4.141q-.657 2.629-1.972 4.995zm-.329-7.756q.197-1.38.197-2.826t-.197-2.826h-6.573q-.197 1.38-.197 2.826t.197 2.826h6.573zM14 25.173q1.84-2.695 2.695-5.587h-5.39q.854 2.892 2.695 5.587zM8.413 8.413q.789-2.826 1.972-4.995-1.643.526-3.451 2.005T4.272 8.414h4.141zM4.272 19.587q.854 1.512 2.662 2.991t3.451 2.005q-1.315-2.366-1.972-4.995H4.272zm-1.117-2.761h4.732Q7.69 15.446 7.69 14t.197-2.826H3.155q-.394 1.84-.394 2.826t.394 2.826zM14 2.826q-1.84 2.695-2.695 5.587h5.39Q15.841 5.521 14 2.826zm9.727 5.587q-.92-1.512-2.695-2.991t-3.418-2.005q1.183 2.169 1.972 4.995h4.141zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_link" xmlns="http://www.w3.org/2000/svg"><path d="M24.037 7.963q3.305 0 5.634 2.366T32 16t-2.329 5.671-5.634 2.366h-6.46v-3.08h6.46q2.028 0 3.493-1.465t1.465-3.493-1.465-3.493-3.493-1.465h-6.46v-3.08h6.46zM9.615 17.578v-3.155h12.77v3.155H9.615zM3.005 16q0 2.028 1.465 3.493t3.493 1.465h6.46v3.08h-6.46q-3.305 0-5.634-2.366T0 16.001t2.329-5.671 5.634-2.366h6.46v3.08h-6.46q-2.028 0-3.493 1.465t-1.465 3.493z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_mastodon" xmlns="http://www.w3.org/2000/svg"><path d="M30.924 10.506c0-6.941-4.548-8.976-4.548-8.976C24.083.477 20.144.034 16.054.001h-.101C11.862.034 7.926.477 5.633 1.53c0 0-4.548 2.035-4.548 8.976 0 1.589-.031 3.491.02 5.505.165 6.79 1.245 13.479 7.522 15.14 2.893.765 5.379.927 7.38.816 3.629-.2 5.667-1.296 5.667-1.296l-.12-2.633s-2.593.817-5.505.719c-2.887-.099-5.932-.311-6.399-3.855a7.069 7.069 0 0 1-.064-.967v-.028.001s2.833.693 6.423.857c2.195.1 4.253-.129 6.344-.377 4.009-.479 7.5-2.949 7.939-5.207.689-3.553.633-8.676.633-8.676zm-5.366 8.945h-3.329v-8.159c0-1.72-.724-2.592-2.171-2.592-1.6 0-2.403 1.035-2.403 3.083v4.465h-3.311v-4.467c0-2.048-.803-3.083-2.403-3.083-1.447 0-2.171.873-2.171 2.592v8.159H6.441v-8.404c0-1.719.437-3.084 1.316-4.093.907-1.011 2.092-1.528 3.565-1.528 1.704 0 2.995.655 3.848 1.965l.828 1.391.829-1.391c.853-1.311 2.144-1.965 3.848-1.965 1.472 0 2.659.517 3.565 1.528.877 1.009 1.315 2.375 1.315 4.093z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_matrix" xmlns="http://www.w3.org/2000/svg"><path d="M.843.734v30.532H3.04v.733H0V0h3.04v.733zm9.391 9.68v1.543h.044a4.417 4.417 0 0 1 1.489-1.365c.577-.327 1.248-.487 2-.487.72 0 1.377.143 1.975.419.597.277 1.047.776 1.36 1.477.339-.499.8-.941 1.379-1.323.579-.383 1.267-.573 2.061-.573.604 0 1.163.075 1.68.223a3.34 3.34 0 0 1 1.324.707c.368.327.652.745.861 1.268.203.523.307 1.151.307 1.889v7.637h-3.132v-6.468c0-.381-.013-.745-.043-1.083a2.315 2.315 0 0 0-.246-.893l.006.013a1.484 1.484 0 0 0-.577-.593l-.007-.004c-.259-.147-.609-.221-1.047-.221-.443 0-.8.085-1.071.252-.267.166-.483.39-.635.656l-.005.009a2.558 2.558 0 0 0-.307.915l-.002.013a7.156 7.156 0 0 0-.08 1.044v6.359h-3.133v-6.4c0-.339-.005-.671-.024-1.003a2.772 2.772 0 0 0-.197-.936l.007.019a1.41 1.41 0 0 0-.548-.667l-.006-.003c-.259-.167-.635-.253-1.139-.253-.148 0-.345.032-.585.099-.24.068-.48.191-.707.376-.228.184-.425.449-.585.793-.16.345-.24.8-.24 1.36v6.621H7.279v-11.42zm20.923 20.852V.734H28.96V.001H32V32h-3.04v-.733z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_menu" xmlns="http://www.w3.org/2000/svg"><path d="M.001 5.334h31.998v3.583H.001V5.334zm0 12.416v-3.5h31.998v3.5H.001zm0 8.916v-3.583h31.998v3.583H.001z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_notification" xmlns="http://www.w3.org/2000/svg"><path d="m22.615 19.384 2.894 2.894v1.413H2.49v-1.413l2.894-2.894V12.25q0-3.365 1.716-5.856t4.745-3.231v-1.01q0-.875.606-1.514T13.999 0t1.548.639.606 1.514v1.01q3.029.74 4.745 3.231t1.716 5.856v7.134zM14 27.999q-1.211 0-2.053-.808t-.841-2.019h5.788q0 1.144-.875 1.986T14 27.999z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_path" xmlns="http://www.w3.org/2000/svg"><path d="M28 12.62h-9.793V8.414h-2.826v11.173h2.826v-4.206H28V26.62h-9.793v-4.206H12.62v-14H9.794v4.206H.001V1.381h9.793v4.206h8.413V1.381H28V12.62z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_person" xmlns="http://www.w3.org/2000/svg"><path d="M16 20.023q5.052 0 10.526 2.199t5.473 5.754v4.023H0v-4.023q0-3.555 5.473-5.754t10.526-2.199zM16 16q-3.275 0-5.614-2.339T8.047 8.047t2.339-5.661T16 0t5.614 2.386 2.339 5.661-2.339 5.614T16 16z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_search" xmlns="http://www.w3.org/2000/svg"><path d="M11.925 20.161q3.432 0 5.834-2.402t2.402-5.834-2.402-5.834-5.834-2.402-5.834 2.402-2.402 5.834 2.402 5.834 5.834 2.402zm10.981 0L32 29.255 29.255 32l-9.094-9.094v-1.458l-.515-.515q-3.26 2.831-7.721 2.831-4.976 0-8.45-3.432T.001 11.925t3.474-8.45 8.45-3.474 8.407 3.474 3.432 8.45q0 1.802-.858 4.075t-1.973 3.646l.515.515h1.458z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_shield" xmlns="http://www.w3.org/2000/svg"><path d="M22.167 15.166V3.5h-8.166v20.726c.93-.492 2.424-1.349 3.883-2.497 1.95-1.531 4.284-3.919 4.284-6.562zm3.499-13.999v14c0 7.674-10.737 12.523-11.192 12.724-.146.073-.31.109-.474.109s-.328-.036-.474-.109c-.456-.201-11.192-5.049-11.192-12.724v-14C2.334.529 2.863 0 3.501 0H24.5c.638 0 1.167.529 1.167 1.167z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_star" xmlns="http://www.w3.org/2000/svg"><path d="M14 22.052 5.324 27.31l2.3-9.859L0 10.813l10.056-.854L14 .692l3.944 9.267L28 10.813l-7.624 6.638 2.3 9.859z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_tag" xmlns="http://www.w3.org/2000/svg"><path d="M17.52 17.52v-7.041h-7.041v7.041h7.041zM28 10.479h-7.041v7.041H28v3.439h-7.041V28H17.52v-7.041h-7.041V28H7.04v-7.041H-.001V17.52H7.04v-7.041H-.001V7.04H7.04V-.001h3.439V7.04h7.041V-.001h3.439V7.04H28v3.439z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_timer" xmlns="http://www.w3.org/2000/svg"><path d="M16 29q4.428 0 7.536-3.143t3.107-7.571-3.107-7.536T16 7.643 8.464 10.75t-3.107 7.536 3.107 7.571T16 29zM26.714 9.786q1.214 1.571 2.107 4.036t.893 4.464q0 5.643-4 9.678T16 32t-9.714-4.036-4-9.678 4-9.678T16 4.572q1.929 0 4.464.929t4.107 2.143l2.143-2.214q1.143.929 2.143 2.143zM14.5 19.857v-9.143h3v9.143h-3zM20.571.001v3.071h-9.143V.001h9.143z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_xmpp" xmlns="http://www.w3.org/2000/svg"><path d="M31.995 4.237c-.449.175-1.12.433-1.936.745-1.544.591-2.328.891-2.924 1.093-.613.208-1.287.409-2.635.813-.911.272-1.672.495-2.212.651-.031.875 0 2.177-.292 3.635a21.837 21.837 0 0 1-2.016 5.765c-1.496 2.944-3.236 4.817-3.88 5.476-.056-.059-.112-.117-.168-.179-.707-.763-2.403-2.703-3.815-5.683-1.053-2.223-1.484-4.044-1.605-4.584-.356-1.589-.427-2.955-.427-4.117 0-.075-.036-.129-.101-.149-.721-.223-1.765-.519-2.887-.853-1.271-.379-2.193-.744-3.408-1.2-.493-.185-1.409-.547-2.217-.859C.723 4.499.113 4.236.041 4.236c-.005 0-.015 0-.023.012a.131.131 0 0 0-.019.076c.009.593.08 1.361.256 2.365.615 3.503 2.688 7.061 4.36 9.244 0 0 3.717 5.035 9.128 8.144l.303.176c-.009.008-.02.015-.028.021-1.717 1.316-3.201 1.977-3.579 2.14a15.71 15.71 0 0 1-2.219.772v.407a25.31 25.31 0 0 0 2.72-.487 26.72 26.72 0 0 0 5.075-1.792c.136.067.276.136.42.204 1.527.725 3.571 1.627 6.073 2.048.613.103 1.136.165 1.507.195a.109.109 0 0 0 .115-.091.55.55 0 0 0 .004-.217.107.107 0 0 0-.063-.073c-.505-.209-1.201-.4-1.983-.719-.935-.381-2.241-1.067-3.648-2.128a13.528 13.528 0 0 1-.367-.287c4.64-2.656 7.989-6.588 7.989-6.588 1.735-2.036 4.441-5.623 5.431-9.795.349-1.473.539-2.741.5-3.628z"/></svg></defs></svg>




    <div
      class="wrapper "
    >
      
      <header class="gdoc-header">
  <div class="container flex align-center justify-between">
    
      <label for="menu-control" class="gdoc-nav__control">
        <div tabindex="0" role="button" aria-pressed="false">
          <input type="checkbox" class="hidden" id="menu-control" />

          <svg class="gdoc-icon gdoc_menu">
            <title>Open Navigation</title>
            <use xlink:href="#gdoc_menu"></use>
          </svg>
          <svg class="gdoc-icon gdoc_arrow_back">
            <title>Close Navigation</title>
            <use xlink:href="#gdoc_arrow_back"></use>
          </svg>
        </div>
      </label>
    
    <div>
      <a class="gdoc-brand gdoc-header__link" href="http://localhost:1313/">
        <span class="flex align-center">
          <img
            class="gdoc-brand__img"
            src="/brand.svg"
            alt=""
          />
          <span class="gdoc-brand__title">raphi&#39;s corner</span>
        </span>
      </a>
    </div>
    <div class="gdoc-menu-header flex gap-16">
      <span class="gdoc-menu-header__items">
        


        <span id="gdoc-color-theme" tabindex="0" role="button" aria-pressed="false">
          <svg class="gdoc-icon gdoc_brightness_dark">
            <title>Toggle Dark/Light/Auto mode</title>
            <use xlink:href="#gdoc_brightness_dark"></use>
          </svg>
          <svg class="gdoc-icon gdoc_brightness_light">
            <title>Toggle Dark/Light/Auto mode</title>
            <use xlink:href="#gdoc_brightness_light"></use>
          </svg>
          <svg class="gdoc-icon gdoc_brightness_auto">
            <title>Toggle Dark/Light/Auto mode</title>
            <use xlink:href="#gdoc_brightness_auto"></use>
          </svg>
        </span>

        <span class="gdoc-menu-header__home">
          <a href="http://localhost:1313/" class="gdoc-header__link">
            <svg class="gdoc-icon gdoc_home">
              <title>Back to homepage</title>
              <use xlink:href="#gdoc_home"></use>
            </svg>
          </a>
        </span>

        

      </span>
      <span class="gdoc-menu-header__control">
        <label for="menu-header-control">
          <div tabindex="0" role="button" aria-pressed="false">
            <input type="checkbox" class="hidden" id="menu-header-control" />

            <svg class="gdoc-icon gdoc_keyboard_arrow_right">
              <use xlink:href="#gdoc_keyboard_arrow_right"></use>
              <title>Close Menu Bar</title>
            </svg>

            <svg class="gdoc-icon gdoc_keyboard_arrow_left">
              <use xlink:href="#gdoc_keyboard_arrow_left"></use>
              <title>Open Menu Bar</title>
            </svg>
          </div>
        </label>
      </span>
    </div>
  </div>
</header>



      <main class="container flex flex-even">
        
          <aside class="gdoc-nav">
            <nav>
  
  <div class="gdoc-search flex align-center">
    <svg class="gdoc-icon gdoc_search"><use xlink:href="#gdoc_search"></use></svg>
    <input
      type="text"
      id="gdoc-search-input"
      class="gdoc-search__input"
      placeholder="Search..."
      aria-label="Search"
      maxlength="64"
      data-site-base-url="http://localhost:1313/"
      data-site-lang="en"
    />
    <ul id="gdoc-search-results" class="gdoc-search__list"></ul>
  </div>




  <section class="gdoc-nav--main">
    <h2>Navigation</h2>
    
      

  


  <ul class="gdoc-nav__list">
    
    
      

      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">Oracle</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/oracle/ash/"
                    class="gdoc-nav__entry"
                  >
                    active session history
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/oracle/ashtop/"
                    class="gdoc-nav__entry is-active"
                  >
                    ashtop
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">Postgres</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/postgres/pgbench/"
                    class="gdoc-nav__entry"
                  >
                    pgbench
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/postgres/pgstat_snap/"
                    class="gdoc-nav__entry"
                  >
                    pgstat_snap
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">Stuff</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/stuff/stuff/"
                    class="gdoc-nav__entry"
                  >
                    other stuff
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
  </ul>






    
  </section>

  


  <section class="gdoc-nav--more">
    
  </section>
</nav>

          </aside>
        


        <div class="gdoc-page">
          
  <article class="gdoc-post" id="main-content" tabindex="-1">
    <header class="gdoc-post__header">
      <h1 class="gdoc-post__title">ashtop</h1>
      <div class="flex flex-wrap align-center gdoc-post__meta gdoc-post__meta--head">
        <span class="flex align-center no-wrap">
  <svg class="gdoc-icon gdoc_date"><use xlink:href="#gdoc_date"></use></svg>
  <span class="gdoc-post__tag">
    <time datetime="0001-01-01T00:00:00Z">
      
      Jan 1, 0001
    </time>
  </span>
</span>

<span class="flex align-center no-wrap">
  <svg class="gdoc-icon gdoc_timer"><use xlink:href="#gdoc_timer"></use></svg>
  <span class="gdoc-post__tag">11 minutes to read</span>
</span>






      </div>
    </header>
    <section class="gdoc-markdown">
      <div class="flex align-center gdoc-page__anchorwrap">
    <h2 id="ashtop---the-swiss-army-knife-for-ash"
    >
        ashtop - the Swiss Army Knife for ASH
    </h2>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#ashtop---the-swiss-army-knife-for-ash" class="gdoc-page__anchor clip flex align-center" title="Anchor to: ashtop - the Swiss Army Knife for ASH" aria-label="Anchor to: ashtop - the Swiss Army Knife for ASH" href="#ashtop---the-swiss-army-knife-for-ash">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<div class="table-wrap"> <table><tr><td style="padding-top: 5%">
<img src="/oracle/ashtop.jpg" alt="ashtop" width="100%" height="100%"/>
</td><td width="50%" valign="top">
<h2>Table of content</h2>
<div class="gdoc-toc gdoc-toc__level--2">
      <nav id="TableOfContents"><ul>
        <li><a href="#ashtop---the-swiss-army-knife-for-ash">ashtop - the Swiss Army Knife for ASH</a></li>
        <li><a href="#syntax">Syntax</a>
          <ul>
            <li><a href="#structure-of-ashtop">Structure of ashtop</a></li>
            <li><a href="#time-specifications">Time specifications</a></li>
            <li><a href="#derived-columns">Derived columns</a>
              <ul>
                <li><a href="#username-and-objt">username and objt</a></li>
                <li><a href="#event2">event2</a></li>
                <li><a href="#time_model_name">time_model_name</a>
                  <ul>
                    <li><a href="#meaning-of-some-of-the-time_model_name">Meaning of some of the time_model_name</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><a href="#empty-sql_id">Empty SQL_ID</a></li>
            <li><a href="#formatting">Formatting</a></li>
            <li><a href="#customizing-ashtopsql">Customizing ashtop.sql</a>
              <ul>
                <li><a href="#working-with-a-copy-of-the-ash">Working with a copy of the ASH</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#using-ashtop">Using ashtop</a></li>
        <li><a href="#example-queries">Example queries</a>
          <ul>
            <li><a href="#top-events-of-the-last-hour">Top events of the last hour</a></li>
            <li><a href="#top-waits-of-the-last-5-minutes">Top waits of the last 5 minutes</a></li>
            <li><a href="#sessions-with-highest-cpu-usage">Sessions with highest CPU usage</a></li>
            <li><a href="#sessions-with-the-highest-io-waits">Sessions with the highest I/O waits</a></li>
            <li><a href="#what-was-the-application-doing">What was the application doing</a></li>
            <li><a href="#what-was-a-specific-session-doing">What was a specific session doing</a></li>
            <li><a href="#which-waits-on-which-objects">Which waits on which objects</a></li>
            <li><a href="#which-sql-statement-read-the-longest-from-what">Which SQL statement read the longest from what</a></li>
            <li><a href="#what-caused-the-most-log-file-syncs">What caused the most log file syncs</a></li>
            <li><a href="#are-top-sessions-blocked-by-another-session">Are top sessions blocked by another session</a></li>
            <li><a href="#top-blocked-sessions">Top blocked sessions</a></li>
            <li><a href="#on-which-objects-blocked-sessions-each-other">On which objects blocked sessions each other</a></li>
            <li><a href="#highest-pga-usage">Highest PGA usage</a></li>
          </ul>
        </li>
        <li><a href="#sql-plan-statistics">SQL plan statistics</a>
          <ul>
            <li><a href="#with-ashtop">With ashtop</a></li>
            <li><a href="#with-asqlmon">With asqlmon</a></li>
          </ul>
        </li>
        <li><a href="#conclusion">Conclusion</a></li>
      </ul></nav>
      <hr />
    </div>
</td></tr></table> </div>
<p>Tanel Poder&rsquo;s script &ldquo;ashtop.sql&rdquo; greatly simplifies querying ASH and is essentially a fully parameterizable &ldquo;grep&rdquo; for ASH. The script comes in two variants:</p>
<ul>
<li>ashtop.sql  → for querying ASH: <code>gv$active_session_history</code></li>
<li>dashtop.sql → for querying DASH: <code>dba_hist_active_sess_history</code></li>
</ul>
<p>Both scripts are in the &ldquo;ash&rdquo; directory of Tanel&rsquo;s github: <a
  class="gdoc-markdown__link"
  href="https://github.com/tanelpoder/tpt-oracle"
>https://github.com/tanelpoder/tpt-oracle</a></p>
<p><strong>Pro tip:</strong> do yourself a favour and download the whole repository. There are many, many more very useful scripts for all kinds of DBA tasks.</p>
<p>There&rsquo;s also a very good video by Tanel on YouTube that explains how ashtop works:<br>
<a
  class="gdoc-markdown__link"
  href="https://www.youtube.com/watch?v=D7bg1Am7Y9s"
>https://www.youtube.com/watch?v=D7bg1Am7Y9s</a></p>
<p>To use ashtop efficiently, it is necessary to know the structure of ASH and how it works. If you haven&rsquo;t read it yet, check out this post: <a
  class="gdoc-markdown__link"
  href="/oracle/ash"
>Active Session History</a>. Note: whenever I mention &ldquo;ASH&rdquo; or &ldquo;ashtop&rdquo;, the same is true for &ldquo;DASH&rdquo; and &ldquo;dashtop&rdquo;.</p>
<div class="flex align-center gdoc-page__anchorwrap">
    <h2 id="syntax"
    >
        Syntax
    </h2>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#syntax" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Syntax" aria-label="Anchor to: Syntax" href="#syntax">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>The basic syntax is very simple:</p>
<pre tabindex="0"><code>@ashtop &lt;GROUP BY&gt; &lt;FILTER&gt; &lt;BEGIN_TIME&gt; &lt;END_TIME&gt;;
</code></pre><ul>
<li><strong>GROUP BY</strong>: What to group by, e.g., session_id, sql_id, event</li>
<li><strong>FILTER</strong>: What to filter by, e.g., <code>session_type='FOREGROUND'</code> or <code>event like 'gc%'</code></li>
<li><strong>BEGIN_TIME</strong>: From which point in time, e.g., <code>sysdate-1/24</code></li>
<li><strong>END_TIME</strong>: Until which point in time, e.g., <code>sysdate</code></li>
</ul>
<div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="structure-of-ashtop"
    >
        Structure of ashtop
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#structure-of-ashtop" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Structure of ashtop" aria-label="Anchor to: Structure of ashtop" href="#structure-of-ashtop">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>This is the basic structure of the script, quite similar to the basic script covered in the post about ASH. However, the complete script has over 130 lines ;)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">&amp;</span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&#34;TotalSeconds&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gv$active_session_history</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">,</span><span class="w"> </span><span class="n">dba_users</span><span class="w"> </span><span class="n">u</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">,</span><span class="w"> </span><span class="n">dba_objects</span><span class="w"> </span><span class="n">o</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">user_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">user_id</span><span class="w"> </span><span class="p">(</span><span class="o">+</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">current_obj</span><span class="o">#</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">object_id</span><span class="p">(</span><span class="o">+</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="o">&amp;</span><span class="mi">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AND</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="o">&amp;</span><span class="mi">3</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="o">&amp;</span><span class="mi">4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">&amp;</span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s2">&#34;TotalSeconds&#34;</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="mi">1</span><span class="w">
</span></span></span></code></pre></div><div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="time-specifications"
    >
        Time specifications
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#time-specifications" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Time specifications" aria-label="Anchor to: Time specifications" href="#time-specifications">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>BEGIN and END_TIME can be passed to the script in various ways, mixed forms are also possible:</p>
<ul>
<li>Relative to sysdate:</li>
</ul>
<pre tabindex="0"><code>@ashtop username,sql_id session_type=&#39;FOREGROUND&#39; sysdate-1/24/12 sysdate;
</code></pre><ul>
<li>ANSI syntax 1:</li>
</ul>
<pre tabindex="0"><code>@ashtop username,sql_id session_type=&#39;FOREGROUND&#39; DATE&#39;2021-08-24&#39; DATE&#39;2021-08-25&#39;;
</code></pre><ul>
<li>ANSI syntax 2:</li>
</ul>
<pre tabindex="0"><code>@ashtop username,sql_id session_type=&#39;FOREGROUND&#39; &#34;TIMESTAMP&#39;2024-04-17 18:00:00&#39;&#34; &#34;TIMESTAMP&#39;2024-04-17 20:00:00&#39;&#34;;
</code></pre><ul>
<li>to_date:</li>
</ul>
<pre tabindex="0"><code>@ashtop username,sql_id session_type=&#39;FOREGROUND&#39; &#34;to_date(&#39;24-AUG-21 18:00&#39;, &#39;DD-MON-YY HH24:MI&#39;)&#34; sysdate;
</code></pre><p>More info on using ANSI syntax in Tanel&rsquo;s scripts:<br>
<a
  class="gdoc-markdown__link"
  href="https://tanelpoder.com/2012/12/29/a-tip-for-lazy-oracle-users-type-less-with-ansi-date-and-timestamp-sql-syntax/"
>https://tanelpoder.com/2012/12/29/a-tip-for-lazy-oracle-users-type-less-with-ansi-date-and-timestamp-sql-syntax/</a></p>
<div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="derived-columns"
    >
        Derived columns
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#derived-columns" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Derived columns" aria-label="Anchor to: Derived columns" href="#derived-columns">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>The script includes various derived columns that do not exist like this in ASH.</p>
<div class="flex align-center gdoc-page__anchorwrap">
    <h4 id="username-and-objt"
    >
        username and objt
    </h4>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#username-and-objt" class="gdoc-page__anchor clip flex align-center" title="Anchor to: username and objt" aria-label="Anchor to: username and objt" href="#username-and-objt">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>Users and objects are only listed as IDs in ASH; if you want the names, you have to join dba_user and dba_objects. Ashtop simplifies this with the columns <code>username</code> and <code>objt</code>. These columns can be used as GROUP BY and as filters.</p>
<p>For example, to show the top 15 users accessing an object named &ldquo;TABLE_NAME&rdquo;:</p>
<pre tabindex="0"><code>@ashtop username &#34;objt=&#39;TABLE_NAME&#39;&#34; sysdate-1/24 sysdate;
</code></pre><p>Or the top objects accessed by the user &ldquo;USER&rdquo;:</p>
<pre tabindex="0"><code>@ashtop objt &#34;username=&#39;USER&#39;&#34; sysdate-1/24 sysdate;
</code></pre><p>The script always returns the top 15 rows that match the specified arguments. Usually, that&rsquo;s enough, but it also means you don&rsquo;t see the rest of the waits. If you can&rsquo;t find the cause of a problem with ashtop, you should analyze the ASH with the basic script described in the post about ASH.</p>
<div class="flex align-center gdoc-page__anchorwrap">
    <h4 id="event2"
    >
        event2
    </h4>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#event2" class="gdoc-page__anchor clip flex align-center" title="Anchor to: event2" aria-label="Anchor to: event2" href="#event2">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>When a session is on the CPU, the EVENT column is NULL. To see that it was really on the CPU, you would have to output SESSION_STATE as well:</p>
<pre tabindex="0"><code>@ashtop sql_id,session_state,event 1=1 sysdate-1/24 sysdate;
</code></pre><p>Example output:</p>
<div class="table-wrap"> <table>
  <thead>
      <tr>
          <th style="text-align: left">Seconds</th>
          <th style="text-align: left">AAS</th>
          <th style="text-align: left">%This</th>
          <th style="text-align: left">SQL_ID</th>
          <th style="text-align: left">SESSION</th>
          <th style="text-align: left">EVENT</th>
          <th style="text-align: left">FIRST_SEEN</th>
          <th style="text-align: left">LAST_SEEN</th>
          <th style="text-align: left">Execs Seen</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">2343</td>
          <td style="text-align: left">.7</td>
          <td style="text-align: left">5%</td>
          <td style="text-align: left">c0syzmwpwp3mw</td>
          <td style="text-align: left">ON CPU</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">2021-09-10 12:44:19</td>
          <td style="text-align: left">2021-09-10 13:44:16</td>
          <td style="text-align: left">1449</td>
      </tr>
      <tr>
          <td style="text-align: left">1524</td>
          <td style="text-align: left">.4</td>
          <td style="text-align: left">3%</td>
          <td style="text-align: left">fj40waf596jva</td>
          <td style="text-align: left">ON CPU</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">2021-09-10 12:44:21</td>
          <td style="text-align: left">2021-09-10 13:44:16</td>
          <td style="text-align: left">7</td>
      </tr>
  </tbody>
</table> </div>
<p>To avoid having to always specify session_state, you can simply use the column &ldquo;event2&rdquo;:</p>
<pre tabindex="0"><code>@ashtop sql_id,event2 1=1 sysdate-1/24 sysdate;
</code></pre><p>Example output:</p>
<div class="table-wrap"> <table>
  <thead>
      <tr>
          <th style="text-align: left">Seconds</th>
          <th style="text-align: left">AAS</th>
          <th style="text-align: left">%This</th>
          <th style="text-align: left">SQL_ID</th>
          <th style="text-align: left">EVENT2</th>
          <th style="text-align: left">FIRST_SEEN</th>
          <th style="text-align: left">LAST_SEEN</th>
          <th style="text-align: left">Execs Seen</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">2343</td>
          <td style="text-align: left">.7</td>
          <td style="text-align: left">5%</td>
          <td style="text-align: left">c0syzmwpwp3mw</td>
          <td style="text-align: left">ON CPU</td>
          <td style="text-align: left">2021-09-10 12:44:32</td>
          <td style="text-align: left">2021-09-10 13:44:29</td>
          <td style="text-align: left">1449</td>
      </tr>
      <tr>
          <td style="text-align: left">1528</td>
          <td style="text-align: left">.4</td>
          <td style="text-align: left">3%</td>
          <td style="text-align: left">fj40waf596jva</td>
          <td style="text-align: left">ON CPU</td>
          <td style="text-align: left">2021-09-10 12:44:30</td>
          <td style="text-align: left">2021-09-10 13:44:29</td>
          <td style="text-align: left">7</td>
      </tr>
  </tbody>
</table> </div>
<p>A value of 1 for AAS and &ldquo;ON CPU&rdquo; EVENT2 means that approximately one CPU core was busy with this execution. The value scales; AAS of 5 means 5 cores were busy.</p>
<div class="flex align-center gdoc-page__anchorwrap">
    <h4 id="time_model_name"
    >
        time_model_name
    </h4>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#time_model_name" class="gdoc-page__anchor clip flex align-center" title="Anchor to: time_model_name" aria-label="Anchor to: time_model_name" href="#time_model_name">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>ASH offers many columns that show which step of execution the query was currently in, e.g. Hard Parse or SQL Execution:</p>
<div class="table-wrap"> <table>
  <thead>
      <tr>
          <th style="text-align: left">Column</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">IN_CONNECTION_MGMT</td>
          <td style="text-align: left">Was the session doing connection management at sampling? (Y/N)</td>
      </tr>
      <tr>
          <td style="text-align: left">IN_PARSE</td>
          <td style="text-align: left">Was the session parsing at sampling? (Y/N)</td>
      </tr>
      <tr>
          <td style="text-align: left">IN_HARD_PARSE</td>
          <td style="text-align: left">Was the session hard parsing at sampling? (Y/N)</td>
      </tr>
      <tr>
          <td style="text-align: left">IN_SQL_EXECUTION</td>
          <td style="text-align: left">Was the session executing SQL at sampling? (Y/N)</td>
      </tr>
      <tr>
          <td style="text-align: left">IN_PLSQL_EXECUTION</td>
          <td style="text-align: left">Was the session executing PL/SQL at sampling? (Y/N)</td>
      </tr>
      <tr>
          <td style="text-align: left">IN_PLSQL_RPC</td>
          <td style="text-align: left">Was the session executing inbound PL/SQL RPC at sampling? (Y/N)</td>
      </tr>
      <tr>
          <td style="text-align: left">IN_PLSQL_COMPILATION</td>
          <td style="text-align: left">Was the session compiling PL/SQL at sampling? (Y/N)</td>
      </tr>
      <tr>
          <td style="text-align: left">IN_JAVA_EXECUTION</td>
          <td style="text-align: left">Was the session executing Java at sampling? (Y/N)</td>
      </tr>
      <tr>
          <td style="text-align: left">IN_BIND</td>
          <td style="text-align: left">Was the session doing bind operations at sampling? (Y/N)</td>
      </tr>
      <tr>
          <td style="text-align: left">IN_CURSOR_CLOSE</td>
          <td style="text-align: left">Was the session closing a cursor at sampling? (Y/N)</td>
      </tr>
      <tr>
          <td style="text-align: left">IN_SEQUENCE_LOAD</td>
          <td style="text-align: left">Was the session loading in sequence at sampling? (Y/N)</td>
      </tr>
      <tr>
          <td style="text-align: left">IN_INMEMORY_QUERY</td>
          <td style="text-align: left">Was the session querying In-Memory Column Store? (Y/N)</td>
      </tr>
      <tr>
          <td style="text-align: left">IN_INMEMORY_POPULATE</td>
          <td style="text-align: left">Was the session populating IM column store? (Y/N)</td>
      </tr>
      <tr>
          <td style="text-align: left">IN_INMEMORY_PREPOPULATE</td>
          <td style="text-align: left">Was the session prepopulating IM column store? (Y/N)</td>
      </tr>
      <tr>
          <td style="text-align: left">IN_INMEMORY_REPOPULATE</td>
          <td style="text-align: left">Was the session repopulating IM column store? (Y/N)</td>
      </tr>
      <tr>
          <td style="text-align: left">IN_INMEMORY_TREPOPULATE</td>
          <td style="text-align: left">Was the session trickle repopulating IM column store? (Y/N)</td>
      </tr>
      <tr>
          <td style="text-align: left">IN_TABLESPACE_ENCRYPTION</td>
          <td style="text-align: left">Was encryption/decryption of a tablespace occurring? (Y/N)</td>
      </tr>
  </tbody>
</table> </div>
<p>To avoid passing all these columns as arguments to ashtop, you can use the derived column &ldquo;time_model_name&rdquo;. It is based on the ASH &ldquo;Time_Model&rdquo; bitfield and maps the value to a descriptive text:</p>
<pre tabindex="0"><code>@ashtop sql_id,time_model_name 1=1 sysdate-1/24 sysdate;
</code></pre><p>Example output:</p>
<div class="table-wrap"> <table>
  <thead>
      <tr>
          <th style="text-align: left">Seconds</th>
          <th style="text-align: left">AAS</th>
          <th style="text-align: left">%This</th>
          <th style="text-align: left">SQL_ID</th>
          <th style="text-align: left">TIME_MODEL_NAME</th>
          <th style="text-align: left">FIRST_SEEN</th>
          <th style="text-align: left">LAST_SEEN</th>
          <th style="text-align: left">Execs Seen</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">737</td>
          <td style="text-align: left">.2</td>
          <td style="text-align: left">4%</td>
          <td style="text-align: left">g9u23ytkurdwz</td>
          <td style="text-align: left">SQL_EXECUTION</td>
          <td style="text-align: left">2021-09-13 12:18:58</td>
          <td style="text-align: left">2021-09-13 13:16:23</td>
          <td style="text-align: left">737</td>
      </tr>
      <tr>
          <td style="text-align: left">549</td>
          <td style="text-align: left">.2</td>
          <td style="text-align: left">3%</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">CONNECTION_MGMT</td>
          <td style="text-align: left">2021-09-13 12:19:03</td>
          <td style="text-align: left">2021-09-13 13:18:27</td>
          <td style="text-align: left">1</td>
      </tr>
      <tr>
          <td style="text-align: left">480</td>
          <td style="text-align: left">.1</td>
          <td style="text-align: left">3%</td>
          <td style="text-align: left">1pyct56psc65z</td>
          <td style="text-align: left">SQL_EXECUTION</td>
          <td style="text-align: left">2021-09-13 12:19:03</td>
          <td style="text-align: left">2021-09-13 13:18:51</td>
          <td style="text-align: left">480</td>
      </tr>
      <tr>
          <td style="text-align: left">478</td>
          <td style="text-align: left">.1</td>
          <td style="text-align: left">3%</td>
          <td style="text-align: left">6u8vh1hymdfh3</td>
          <td style="text-align: left">SQL_EXECUTION</td>
          <td style="text-align: left">2021-09-13 12:18:54</td>
          <td style="text-align: left">2021-09-13 13:18:52</td>
          <td style="text-align: left">478</td>
      </tr>
  </tbody>
</table> </div>
<div class="flex align-center gdoc-page__anchorwrap">
    <h5 id="meaning-of-some-of-the-time_model_name"
    >
        Meaning of some of the time_model_name
    </h5>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#meaning-of-some-of-the-time_model_name" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Meaning of some of the time_model_name" aria-label="Anchor to: Meaning of some of the time_model_name" href="#meaning-of-some-of-the-time_model_name">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<div class="table-wrap"> <table>
  <thead>
      <tr>
          <th style="text-align: left">Time_Model_Name</th>
          <th style="text-align: left">Meaning</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">SQL_EXECUTION</td>
          <td style="text-align: left">Statement is being executed</td>
      </tr>
      <tr>
          <td style="text-align: left">PARSE</td>
          <td style="text-align: left">Soft parse</td>
      </tr>
      <tr>
          <td style="text-align: left">HARD_PARSE</td>
          <td style="text-align: left">Hard parse</td>
      </tr>
      <tr>
          <td style="text-align: left">PARSE HARD_PARSE</td>
          <td style="text-align: left">Soft parse attempted, ended in hard parse</td>
      </tr>
      <tr>
          <td style="text-align: left">CONNECTION_MGMT</td>
          <td style="text-align: left">Login/Logouts</td>
      </tr>
      <tr>
          <td style="text-align: left">BIND</td>
          <td style="text-align: left">Binds are being filled</td>
      </tr>
      <tr>
          <td style="text-align: left">(Empty line)</td>
          <td style="text-align: left">Step not represented in ASH</td>
      </tr>
  </tbody>
</table> </div>
<div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="empty-sql_id"
    >
        Empty SQL_ID
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#empty-sql_id" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Empty SQL_ID" aria-label="Anchor to: Empty SQL_ID" href="#empty-sql_id">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>Sometimes ashtop shows no SQL_ID for a session, either because the session belongs to a background process (in that case, the user is SYS and SESSION_TYPE is BACKGROUND) or because the session is mainly waiting for commits.</p>
<pre tabindex="0"><code>@ashtop sql_id,event2,username 1=1 sysdate-1/24 sysdate;
</code></pre><p>Example output:</p>
<div class="table-wrap"> <table>
  <thead>
      <tr>
          <th style="text-align: left">Seconds</th>
          <th style="text-align: left">AAS</th>
          <th style="text-align: left">%This</th>
          <th style="text-align: left">SQL_ID</th>
          <th style="text-align: left">EVENT2</th>
          <th style="text-align: left">USERNAME</th>
          <th style="text-align: left">SESSION_TYPE</th>
          <th style="text-align: left">FIRST_SEEN</th>
          <th style="text-align: left">LAST_SEEN</th>
          <th style="text-align: left">Execs Seen</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">3068</td>
          <td style="text-align: left">.9</td>
          <td style="text-align: left">57%</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">log file sync</td>
          <td style="text-align: left">RAPHI_APPL</td>
          <td style="text-align: left">FOREGROUND</td>
          <td style="text-align: left">2021-09-13 11:50:28</td>
          <td style="text-align: left">2021-09-13 12:50:23</td>
          <td style="text-align: left">1</td>
      </tr>
      <tr>
          <td style="text-align: left">809</td>
          <td style="text-align: left">.2</td>
          <td style="text-align: left">15%</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">ON CPU</td>
          <td style="text-align: left">RAPHI_APPL</td>
          <td style="text-align: left">FOREGROUND</td>
          <td style="text-align: left">2021-09-13 11:50:26</td>
          <td style="text-align: left">2021-09-13 12:50:21</td>
          <td style="text-align: left">1</td>
      </tr>
      <tr>
          <td style="text-align: left">100</td>
          <td style="text-align: left">.0</td>
          <td style="text-align: left">2%</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">ON CPU</td>
          <td style="text-align: left">SYS</td>
          <td style="text-align: left">BACKGROUND</td>
          <td style="text-align: left">2021-09-13 11:51:19</td>
          <td style="text-align: left">2021-09-13 12:50:03</td>
          <td style="text-align: left">1</td>
      </tr>
  </tbody>
</table> </div>
<p>If you want to see what the user session is actually doing even though no SQL_ID is listed, you can search for &ldquo;Top_Level_Call_Name&rdquo;:</p>
<pre tabindex="0"><code>@ashtop sql_id,top_level_call_name,event2 &#34;sql_id is null and username=&#39;RAPHI_APPL&#39;&#34; sysdate-1/24 sysdate;
</code></pre><p>Example output:</p>
<div class="table-wrap"> <table>
  <thead>
      <tr>
          <th style="text-align: left">Seconds</th>
          <th style="text-align: left">AAS</th>
          <th style="text-align: left">%This</th>
          <th style="text-align: left">SQL_ID</th>
          <th style="text-align: left">TOP_LEVEL_CALL_NAME</th>
          <th style="text-align: left">EVENT2</th>
          <th style="text-align: left">FIRST_SEEN</th>
          <th style="text-align: left">LAST_SEEN</th>
          <th style="text-align: left">Execs Seen</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">2879</td>
          <td style="text-align: left">.8</td>
          <td style="text-align: left">65%</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">COMMIT</td>
          <td style="text-align: left">log file sync</td>
          <td style="text-align: left">2021-09-13 11:54:40</td>
          <td style="text-align: left">2021-09-13 12:54:38</td>
          <td style="text-align: left">1</td>
      </tr>
      <tr>
          <td style="text-align: left">195</td>
          <td style="text-align: left">.1</td>
          <td style="text-align: left">4%</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">COMMIT</td>
          <td style="text-align: left">ON CPU</td>
          <td style="text-align: left">2021-09-13 11:55:09</td>
          <td style="text-align: left">2021-09-13 12:54:13</td>
          <td style="text-align: left">1</td>
      </tr>
      <tr>
          <td style="text-align: left">183</td>
          <td style="text-align: left">.1</td>
          <td style="text-align: left">4%</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">V8 Bundled Exec</td>
          <td style="text-align: left">ON CPU</td>
          <td style="text-align: left">2021-09-13 11:55:56</td>
          <td style="text-align: left">2021-09-13 12:54:05</td>
          <td style="text-align: left">1</td>
      </tr>
  </tbody>
</table> </div>
<div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="formatting"
    >
        Formatting
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#formatting" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Formatting" aria-label="Anchor to: Formatting" href="#formatting">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>Tanel assumes you use his scripts in a terminal where you can scroll horizontally. If not, you should at least increase the linesize and maybe shorten a few columns:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">set</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="mi">400</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">col</span><span class="w"> </span><span class="n">objt</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">a30</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">col</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">a30</span><span class="w">
</span></span></span></code></pre></div><div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="customizing-ashtopsql"
    >
        Customizing ashtop.sql
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#customizing-ashtopsql" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Customizing ashtop.sql" aria-label="Anchor to: Customizing ashtop.sql" href="#customizing-ashtopsql">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>Sometimes it is necessary to customize ashtop.sql, for example to show more than the top 15 events or to sort by another criteria. It&rsquo;s best to create a copy of the original ashtop.sql before you customize it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cp /nas/smdb/scripts/sql/ash/ashtop.sql <span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> <span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">vi ashtop.sql
</span></span></code></pre></div><p>Change the order by and the number of rows returned:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="c1">-- TotalSeconds DESC
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">       </span><span class="n">time_waited</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- ROWNUM &lt;= 15
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="n">ROWNUM</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">30</span><span class="w">
</span></span></span></code></pre></div><div class="flex align-center gdoc-page__anchorwrap">
    <h4 id="working-with-a-copy-of-the-ash"
    >
        Working with a copy of the ASH
    </h4>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#working-with-a-copy-of-the-ash" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Working with a copy of the ASH" aria-label="Anchor to: Working with a copy of the ASH" href="#working-with-a-copy-of-the-ash">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>If a copy of the ASH has been created with CTAS for backup, the following line needs to be changed to the saved ASH:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cp /nas/smdb/scripts/sql/ash/ashtop.sql <span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> <span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">vi ashtop.sql
</span></span><span class="line"><span class="cl">-- FROM gv<span class="nv">$active_session_history</span> a<span class="o">)</span> a
</span></span><span class="line"><span class="cl">   FROM ash_save220901 a<span class="o">)</span> a
</span></span></code></pre></div><div class="flex align-center gdoc-page__anchorwrap">
    <h2 id="using-ashtop"
    >
        Using ashtop
    </h2>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#using-ashtop" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Using ashtop" aria-label="Anchor to: Using ashtop" href="#using-ashtop">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>A simple query looks like this, the structure is always the same:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">sys</span><span class="o">@</span><span class="n">CIS_1</span><span class="o">/</span><span class="n">T1</span><span class="o">&gt;</span><span class="w"> </span><span class="o">@</span><span class="n">ashtop</span><span class="w"> </span><span class="n">username</span><span class="p">,</span><span class="n">sql_id</span><span class="w"> </span><span class="n">session_type</span><span class="o">=</span><span class="s1">&#39;FOREGROUND&#39;</span><span class="w"> </span><span class="n">sysdate</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="n">sysdate</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>Example output:</p>
<div class="table-wrap"> <table>
  <thead>
      <tr>
          <th style="text-align: left">Seconds</th>
          <th style="text-align: left">AAS</th>
          <th style="text-align: left">%This</th>
          <th style="text-align: left">USERNAME</th>
          <th style="text-align: left">SQL_ID</th>
          <th style="text-align: left">FIRST_SEEN</th>
          <th style="text-align: left">LAST_SEEN</th>
          <th style="text-align: left">Execs Seen</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">1184</td>
          <td style="text-align: left">.2</td>
          <td style="text-align: left">9%</td>
          <td style="text-align: left">RAPHI_USER</td>
          <td style="text-align: left">37hs5hm167vhy</td>
          <td style="text-align: left">2019-11-26 12:35:38</td>
          <td style="text-align: left">2019-11-26 12:40:24</td>
          <td style="text-align: left">2</td>
      </tr>
      <tr>
          <td style="text-align: left">583</td>
          <td style="text-align: left">.1</td>
          <td style="text-align: left">4%</td>
          <td style="text-align: left">RAPHI_APPL</td>
          <td style="text-align: left">bxj6rfn7du7c8</td>
          <td style="text-align: left">2019-11-26 11:57:30</td>
          <td style="text-align: left">2019-11-26 12:54:25</td>
          <td style="text-align: left">2</td>
      </tr>
      <tr>
          <td style="text-align: left">378</td>
          <td style="text-align: left">.1</td>
          <td style="text-align: left">3%</td>
          <td style="text-align: left">RAPHI_APPL</td>
          <td style="text-align: left">9jwmpa0zs1czv</td>
          <td style="text-align: left">2019-11-26 12:02:15</td>
          <td style="text-align: left">2019-11-26 12:03:23</td>
          <td style="text-align: left">1</td>
      </tr>
      <tr>
          <td style="text-align: left">&hellip;</td>
          <td style="text-align: left">&hellip;</td>
          <td style="text-align: left">&hellip;</td>
          <td style="text-align: left">&hellip;</td>
          <td style="text-align: left">&hellip;</td>
          <td style="text-align: left">&hellip;</td>
          <td style="text-align: left">&hellip;</td>
          <td style="text-align: left">&hellip;</td>
      </tr>
  </tbody>
</table> </div>
<ul>
<li>First, these three columns are listed:
<ul>
<li><strong>Total Seconds</strong>: How many seconds all executions of the query are listed in ASH for the specified period</li>
<li><strong>AAS</strong>: Average Active Sessions spent per second with the wait event in the specified period</li>
<li><strong>%This</strong>: Ratio of the specified period to seconds all sessions spent with this event</li>
</ul>
</li>
<li>Then, the columns passed as the first argument (GROUP BY) are shown:
<ul>
<li>USERNAME</li>
<li>SQL_ID</li>
</ul>
</li>
<li>Lastly, some timing information
<ul>
<li><strong>FIRST_SEEN</strong>: First execution in the specified period</li>
<li><strong>LAST_SEEN</strong>: Last execution in the specified period</li>
<li><strong>Distinct Execs Seen</strong>: Number of different executions in the specified period</li>
</ul>
</li>
</ul>
<div class="flex align-center gdoc-page__anchorwrap">
    <h2 id="example-queries"
    >
        Example queries
    </h2>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#example-queries" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Example queries" aria-label="Anchor to: Example queries" href="#example-queries">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>There are countless ways to query ASH with ashtop, here is a selection:</p>
<div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="top-events-of-the-last-hour"
    >
        Top events of the last hour
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#top-events-of-the-last-hour" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Top events of the last hour" aria-label="Anchor to: Top events of the last hour" href="#top-events-of-the-last-hour">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<pre tabindex="0"><code>@ashtop event2 1=1 sysdate-1/24 sysdate;
</code></pre><div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="top-waits-of-the-last-5-minutes"
    >
        Top waits of the last 5 minutes
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#top-waits-of-the-last-5-minutes" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Top waits of the last 5 minutes" aria-label="Anchor to: Top waits of the last 5 minutes" href="#top-waits-of-the-last-5-minutes">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<pre tabindex="0"><code>@ashtop event2 &#34;event2 not like &#39;ON CPU&#39;&#34; sysdate-1/24/12 sysdate;
</code></pre><div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="sessions-with-highest-cpu-usage"
    >
        Sessions with highest CPU usage
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#sessions-with-highest-cpu-usage" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Sessions with highest CPU usage" aria-label="Anchor to: Sessions with highest CPU usage" href="#sessions-with-highest-cpu-usage">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<pre tabindex="0"><code>@ashtop session_id,sql_id &#34;event2=&#39;ON CPU&#39;&#34; sysdate-1/24 sysdate;
</code></pre><div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="sessions-with-the-highest-io-waits"
    >
        Sessions with the highest I/O waits
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#sessions-with-the-highest-io-waits" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Sessions with the highest I/O waits" aria-label="Anchor to: Sessions with the highest I/O waits" href="#sessions-with-the-highest-io-waits">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<pre tabindex="0"><code>@ashtop session_id,sql_id,event2 &#34;wait_class = &#39;User I/O&#39;&#34; sysdate-1/24 sysdate;
</code></pre><div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="what-was-the-application-doing"
    >
        What was the application doing
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#what-was-the-application-doing" class="gdoc-page__anchor clip flex align-center" title="Anchor to: What was the application doing" aria-label="Anchor to: What was the application doing" href="#what-was-the-application-doing">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>Assuminge all application users begin with RAPHI_</p>
<pre tabindex="0"><code>@ashtop sql_id,sql_opname,event2 &#34;username like &#39;RAPHI%&#39;&#34; sysdate-1/24 sysdate;
</code></pre><div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="what-was-a-specific-session-doing"
    >
        What was a specific session doing
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#what-was-a-specific-session-doing" class="gdoc-page__anchor clip flex align-center" title="Anchor to: What was a specific session doing" aria-label="Anchor to: What was a specific session doing" href="#what-was-a-specific-session-doing">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<pre tabindex="0"><code>@ashtop sql_id,sql_opname,event2 &#34;session_id=1667 and session_serial#=45570&#34; sysdate-1/24 sysdate;
</code></pre><div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="which-waits-on-which-objects"
    >
        Which waits on which objects
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#which-waits-on-which-objects" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Which waits on which objects" aria-label="Anchor to: Which waits on which objects" href="#which-waits-on-which-objects">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<pre tabindex="0"><code>@ashtop objt,event2,sql_id &#34;event2 NOT LIKE &#39;ON CPU&#39;&#34; sysdate-1/24 sysdate;
</code></pre><div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="which-sql-statement-read-the-longest-from-what"
    >
        Which SQL statement read the longest from what
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#which-sql-statement-read-the-longest-from-what" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Which SQL statement read the longest from what" aria-label="Anchor to: Which SQL statement read the longest from what" href="#which-sql-statement-read-the-longest-from-what">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<pre tabindex="0"><code>@ashtop objt,sql_id &#34;event like &#39;%read%&#39;&#34; sysdate-1/24 sysdate;
</code></pre><div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="what-caused-the-most-log-file-syncs"
    >
        What caused the most log file syncs
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#what-caused-the-most-log-file-syncs" class="gdoc-page__anchor clip flex align-center" title="Anchor to: What caused the most log file syncs" aria-label="Anchor to: What caused the most log file syncs" href="#what-caused-the-most-log-file-syncs">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<pre tabindex="0"><code>@ashtop sql_opname,top_level_call_name &#34;event=&#39;log file sync&#39;&#34; sysdate-1/24 sysdate;
</code></pre><div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="are-top-sessions-blocked-by-another-session"
    >
        Are top sessions blocked by another session
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#are-top-sessions-blocked-by-another-session" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Are top sessions blocked by another session" aria-label="Anchor to: Are top sessions blocked by another session" href="#are-top-sessions-blocked-by-another-session">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<pre tabindex="0"><code>@ashtop session_id,sql_id,event2,blocking_session session_type=&#39;FOREGROUND&#39; sysdate-1/24 sysdate;
</code></pre><div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="top-blocked-sessions"
    >
        Top blocked sessions
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#top-blocked-sessions" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Top blocked sessions" aria-label="Anchor to: Top blocked sessions" href="#top-blocked-sessions">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<pre tabindex="0"><code>@ashtop session_id,sql_id,event2,blocking_session &#34;event2 NOT LIKE &#39;ON CPU&#39; and blocking_session is not null&#34; sysdate-1/24 sysdate;
</code></pre><div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="on-which-objects-blocked-sessions-each-other"
    >
        On which objects blocked sessions each other
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#on-which-objects-blocked-sessions-each-other" class="gdoc-page__anchor clip flex align-center" title="Anchor to: On which objects blocked sessions each other" aria-label="Anchor to: On which objects blocked sessions each other" href="#on-which-objects-blocked-sessions-each-other">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<pre tabindex="0"><code>@ashtop username,sql_id,session_id,event,blocking_session,objt &#34;event like &#39;enq: TX%&#39;&#34; sysdate-1/24 sysdate;
</code></pre><div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="highest-pga-usage"
    >
        Highest PGA usage
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#highest-pga-usage" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Highest PGA usage" aria-label="Anchor to: Highest PGA usage" href="#highest-pga-usage">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>Change the ORDER BY in a copy of ashtop.sql</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">vi</span><span class="w"> </span><span class="n">ashtop</span><span class="p">.</span><span class="k">sql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- TotalSeconds DESC
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w"> </span><span class="n">PGA_ALLOCATED</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span></code></pre></div><p>Then:</p>
<pre tabindex="0"><code>@ashtop pga_allocated,sql_id &#34;session_type=&#39;FOREGROUND&#39;&#34; sysdate-1/24 sysdate;
</code></pre><div class="flex align-center gdoc-page__anchorwrap">
    <h2 id="sql-plan-statistics"
    >
        SQL plan statistics
    </h2>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#sql-plan-statistics" class="gdoc-page__anchor clip flex align-center" title="Anchor to: SQL plan statistics" aria-label="Anchor to: SQL plan statistics" href="#sql-plan-statistics">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>With ASH it&rsquo;s possible to find out in which step of the execution plan the query spent the most time. It can be done with ashtop or with another script from Tanel, asqlmon.</p>
<div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="with-ashtop"
    >
        With ashtop
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#with-ashtop" class="gdoc-page__anchor clip flex align-center" title="Anchor to: With ashtop" aria-label="Anchor to: With ashtop" href="#with-ashtop">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>Unless specified with a hint, SQL Monitor only records statements that ran at least for 5 seconds. If you want to know which part of the execution plan consumed the most time for a query not captured by SQL Monitor, you have to use ASH. The following columns are available:</p>
<div class="table-wrap"> <table>
  <thead>
      <tr>
          <th style="text-align: left">Column</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">SQL_FULL_PLAN_HASH_VALUE</td>
          <td style="text-align: left">Numerical representation of the complete SQL plan for the cursor</td>
      </tr>
      <tr>
          <td style="text-align: left">SQL_PLAN_HASH_VALUE</td>
          <td style="text-align: left">Numeric representation of the SQL plan for the cursor</td>
      </tr>
      <tr>
          <td style="text-align: left">SQL_PLAN_LINE_ID</td>
          <td style="text-align: left">SQL plan line ID</td>
      </tr>
      <tr>
          <td style="text-align: left">SQL_PLAN_OPERATION</td>
          <td style="text-align: left">Plan operation name</td>
      </tr>
      <tr>
          <td style="text-align: left">SQL_PLAN_OPTIONS</td>
          <td style="text-align: left">Plan operation options</td>
      </tr>
  </tbody>
</table> </div>
<p>With the SQL_ID of the statement, you can see where most of the time was spent:</p>
<pre tabindex="0"><code>@ashtop sql_plan_line_id,sql_plan_operation,sql_plan_options &#34;sql_id=&#39;28w88hbtt3766&#39;&#34; sysdate-1/24 sysdate;
</code></pre><p>Example output:</p>
<div class="table-wrap"> <table>
  <thead>
      <tr>
          <th style="text-align: left">Seconds</th>
          <th style="text-align: left">AAS</th>
          <th style="text-align: left">%This</th>
          <th style="text-align: left">SQL_PLAN_LINE_ID</th>
          <th style="text-align: left">SQL_PLAN_OPERATION</th>
          <th style="text-align: left">SQL_PLAN_OPTIONS</th>
          <th style="text-align: left">FIRST_SEEN</th>
          <th style="text-align: left">LAST_SEEN</th>
          <th style="text-align: left">Execs Seen</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">387</td>
          <td style="text-align: left">.1</td>
          <td style="text-align: left">58%</td>
          <td style="text-align: left">8</td>
          <td style="text-align: left">TABLE ACCESS</td>
          <td style="text-align: left">BY LOCAL INDEX ROWID BATCHED</td>
          <td style="text-align: left">2021-09-13 10:38:46</td>
          <td style="text-align: left">2021-09-13 11:11:32</td>
          <td style="text-align: left">159</td>
      </tr>
      <tr>
          <td style="text-align: left">136</td>
          <td style="text-align: left">.0</td>
          <td style="text-align: left">20%</td>
          <td style="text-align: left">9</td>
          <td style="text-align: left">INDEX</td>
          <td style="text-align: left">RANGE SCAN</td>
          <td style="text-align: left">2021-09-13 10:38:46</td>
          <td style="text-align: left">2021-09-13 11:11:31</td>
          <td style="text-align: left">114</td>
      </tr>
      <tr>
          <td style="text-align: left">108</td>
          <td style="text-align: left">.0</td>
          <td style="text-align: left">16%</td>
          <td style="text-align: left">15</td>
          <td style="text-align: left">TABLE ACCESS</td>
          <td style="text-align: left">BY LOCAL INDEX ROWID BATCHED</td>
          <td style="text-align: left">2021-09-13 10:38:50</td>
          <td style="text-align: left">2021-09-13 11:11:33</td>
          <td style="text-align: left">108</td>
      </tr>
      <tr>
          <td style="text-align: left">27</td>
          <td style="text-align: left">.0</td>
          <td style="text-align: left">4%</td>
          <td style="text-align: left">16</td>
          <td style="text-align: left">INDEX</td>
          <td style="text-align: left">SKIP SCAN</td>
          <td style="text-align: left">2021-09-13 10:38:50</td>
          <td style="text-align: left">2021-09-13 11:11:32</td>
          <td style="text-align: left">27</td>
      </tr>
      <tr>
          <td style="text-align: left">4</td>
          <td style="text-align: left">.0</td>
          <td style="text-align: left">1%</td>
          <td style="text-align: left">3</td>
          <td style="text-align: left">SORT</td>
          <td style="text-align: left">UNIQUE</td>
          <td style="text-align: left">2021-09-13 10:38:49</td>
          <td style="text-align: left">2021-09-13 11:11:27</td>
          <td style="text-align: left">4</td>
      </tr>
      <tr>
          <td style="text-align: left">3</td>
          <td style="text-align: left">.0</td>
          <td style="text-align: left">0%</td>
          <td style="text-align: left">11</td>
          <td style="text-align: left">TABLE ACCESS</td>
          <td style="text-align: left">BY GLOBAL INDEX ROWID BATCHED</td>
          <td style="text-align: left">2021-09-13 10:38:47</td>
          <td style="text-align: left">2021-09-13 10:38:53</td>
          <td style="text-align: left">3</td>
      </tr>
      <tr>
          <td style="text-align: left">2</td>
          <td style="text-align: left">.0</td>
          <td style="text-align: left">0%</td>
          <td style="text-align: left">12</td>
          <td style="text-align: left">INDEX</td>
          <td style="text-align: left">RANGE SCAN</td>
          <td style="text-align: left">2021-09-13 10:38:48</td>
          <td style="text-align: left">2021-09-13 11:11:24</td>
          <td style="text-align: left">2</td>
      </tr>
      <tr>
          <td style="text-align: left">1</td>
          <td style="text-align: left">.0</td>
          <td style="text-align: left">0%</td>
          <td style="text-align: left">5</td>
          <td style="text-align: left">FILTER</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">2021-09-13 10:38:46</td>
          <td style="text-align: left">2021-09-13 10:38:46</td>
          <td style="text-align: left">1</td>
      </tr>
  </tbody>
</table> </div>
<p>This means that the query spent 58% of its time reading rows from a table, 20% searching the rows in the index, etc.</p>
<div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="with-asqlmon"
    >
        With asqlmon
    </h3>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#with-asqlmon" class="gdoc-page__anchor clip flex align-center" title="Anchor to: With asqlmon" aria-label="Anchor to: With asqlmon" href="#with-asqlmon">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>Also in the &ldquo;ash&rdquo; directory of Tanel&rsquo;s github repo is the script asqlmon.sql:<br>
<a
  class="gdoc-markdown__link"
  href="https://github.com/tanelpoder/tpt-oracle"
>https://github.com/tanelpoder/tpt-oracle</a></p>
<p>The script simplifies querying plan statistics and provides even more information.</p>
<ul>
<li>First argument: sql_id</li>
<li>Second argument: Plan Hash Value (or % for all plans)</li>
<li>Third argument: Start time</li>
<li>Fourth argument: End time</li>
</ul>
<p>Call for the same query as in the ashtop example:</p>
<pre tabindex="0"><code>@asqlmon 28w88hbtt3766 % sysdate-1/24 sysdate;
</code></pre><p>Output:
<img src="/oracle/asqlmon.jpg" alt="asqlmon" width="100%" height="100%"/></p>
<div class="flex align-center gdoc-page__anchorwrap">
    <h2 id="conclusion"
    >
        Conclusion
    </h2>
    <a data-clipboard-text="http://localhost:1313/oracle/ashtop/#conclusion" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Conclusion" aria-label="Anchor to: Conclusion" href="#conclusion">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>Ashtop is a true time saver when it comes to working with ASH. It is much more flexible than &ldquo;Top Activity/ASH Analytics&rdquo; in Oracle&rsquo;s Enterprise Manager and provides some very handy shortcuts which have to be programmed when using self-made scripts, like the time_model_name column. Other useful scripts from Tanel that go hand-in-hand with ashtop:</p>
<ul>
<li>awr_sqlstats_per_exec       -&gt; discover plan changes of a query</li>
<li>(d)ash_wait_chains          -&gt; follow blocking sessions</li>
<li>(d)aslqmon                  -&gt; execution plan statistics, as described above</li>
<li>nonshared                   -&gt; show reasons why cursors were not shared</li>
<li>help.sql                    -&gt; description for many of Tanel&rsquo;s scripts</li>
</ul>

    </section>
  </article>



          
          
          <div class="gdoc-page__footer flex flex-wrap justify-between">
            
              








  
  

  
  
    

    

    
      
      

      
        
        
        
        

        
        

        

        

        

        
        
          
  
  

  
  
    

    

    
      
      

      
        
        
        
        

        
        

        

        

        
          
        

        
        
      
    

  
    

    

    
      
      

      
        
        
        
        

        
        

        

        
          
          
        

        
          
        

        
        
      
    

  

        
      
    
      
      

      
        
        
        
        

        
        

        
          
        

        

        

        
        
          
  
  

  
  
    

    

    
      
      

      
        
        
        
        

        
        

        
          
            
            
          
        

        

        
          
        

        
        
      
    
      
      

      
        
        
        
        

        
        

        

        

        
          
        

        
        
      
    

  

        
      
    
      
      

      
        
        
        
        

        
        

        

        

        

        
        
          
  
  

  
  
    

    

    
      
      

      
        
        
        
        

        
        

        

        

        
          
        

        
        
      
    

  

        
      
    

  




<span class="gdoc-page__nav">
  
    <a
      class="gdoc-page__nav--prev flex align-center"
      href="/oracle/ash/"
      title="active session history"
    >
      <i class="gdoc-icon">gdoc_arrow_left_alt</i>
      active session history
    </a>
  
</span>
<span class="gdoc-page__nav">
  
    <a
      class="gdoc-page__nav--next flex align-center"
      href="/postgres/pgbench/"
      title="pgbench"
    >
      pgbench
      <i class="gdoc-icon">gdoc_arrow_right_alt</i>
    </a>
  
</span>

            
          </div>
          
        </div>
      </main>

      <footer class="gdoc-footer">
  <nav class="container flex">
    <div>
      <section class="flex flex-wrap align-center">
        <span class="gdoc-footer__item gdoc-footer__item--row">
          Built with <a href="https://gohugo.io/" class="gdoc-footer__link">Hugo</a> and <svg class="gdoc-icon gdoc_heart"><use xlink:href="#gdoc_heart"></use></svg>

        </span>
        
        
      </section>
      
    </div>
    
      <div class="flex flex-25 justify-end">
        <span class="gdoc-footer__item text-right">
          <a class="gdoc-footer__link fake-link" href="#" aria-label="Back to top">
            <svg class="gdoc-icon gdoc_keyboard_arrow_up">
              <use xlink:href="#gdoc_keyboard_arrow_up"></use>
            </svg>
            <span class="hidden-mobile">Back to top</span>
          </a>
        </span>
      </div>
    
  </nav>
</footer>

    </div>

    
  <script defer src="/js/search-16a110ff.bundle.min.js"></script>

  </body>
</html>
