<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>active session history | raphi&#39;s corner</title>
<meta name="description" content="Oracle&#39;s active session history demystified">
<meta property="og:url" content="//localhost:1313/oracle/ash/">
  <meta property="og:site_name" content="raphi&#39;s corner">
  <meta property="og:title" content="active session history">
  <meta property="og:description" content="Oracle&#39;s active session history demystified">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="oracle">
    <meta property="article:modified_time" content="2025-07-09T11:39:31+02:00">

  <meta itemprop="name" content="active session history">
  <meta itemprop="description" content="Oracle&#39;s active session history demystified">
  <meta itemprop="dateModified" content="2025-07-09T11:39:31+02:00">
  <meta itemprop="wordCount" content="3072">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="active session history">
  <meta name="twitter:description" content="Oracle&#39;s active session history demystified">
<link href="/scss/main.css" rel="stylesheet">
<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
  crossorigin="anonymous"></script>

  </head>
  <body class="td-page">
    <header>
      <nav class="td-navbar js-navbar-scroll" data-bs-theme="dark">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class="navbar-brand__name">raphi&#39;s corner</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="https://www.postgresql.org/docs/" target="_blank" rel="noopener"><span>Postgres documentation</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://docs.oracle.com/en/database/oracle/oracle-database/index.html" target="_blank" rel="noopener"><span>Oracle documentation</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://www.perplexity.ai/" target="_blank" rel="noopener"><span>Perplexity</span></a>
      </li>
      <li class="td-light-dark-menu nav-item dropdown">
        <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="check2" viewBox="0 0 16 16">
    <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
  </symbol>
  <symbol id="circle-half" viewBox="0 0 16 16">
    <path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"/>
  </symbol>
  <symbol id="moon-stars-fill" viewBox="0 0 16 16">
    <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
    <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/>
  </symbol>
  <symbol id="sun-fill" viewBox="0 0 16 16">
    <path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
  </symbol>
</svg>

<button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center"
        id="bd-theme"
        type="button"
        aria-expanded="false"
        data-bs-toggle="dropdown"
        data-bs-display="static"
        aria-label="Toggle theme (auto)">
  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg>
</button>
<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
  <li>
    <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
      <svg class="bi me-2 opacity-50"><use href="#sun-fill"></use></svg>
      Light
      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
    </button>
  </li>
  <li>
    <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
      <svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"></use></svg>
      Dark
      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
    </button>
  </li>
  <li>
    <button type="button" class="dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
      <svg class="bi me-2 opacity-50"><use href="#circle-half"></use></svg>
      Auto
      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
    </button>
  </li>
</ul>

      </li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            <div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type="button" data-bs-toggle="collapse" data-bs-target="#td-section-nav" aria-controls="td-section-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  <nav class="td-sidebar-nav collapse" id="td-section-nav">
    <ul class="td-sidebar-nav__section pe-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m--li">
  <a href="/" title="Hi there!" class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-"><span class="">Home</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-postgres-li">
  <a href="/postgres/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-postgres"><span class="">PostgreSQL</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-postgrespgbench-li">
  <a href="/postgres/pgbench/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-postgrespgbench"><span class="">pgbench</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-postgrespgstat_snap-li">
  <a href="/postgres/pgstat_snap/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-postgrespgstat_snap"><span class="">pgstat_snap</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-oracle-li">
  <a href="/oracle/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-oracle"><span class="">Oracle</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-oracleash-li">
  <a href="/oracle/ash/" class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id="m-oracleash"><span class="td-sidebar-nav-active-item">active session history</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-oracleashtop-li">
  <a href="/oracle/ashtop/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-oracleashtop"><span class="">ashtop</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-stuff-li">
  <a href="/stuff/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-stuff"><span class="">Other stuff</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-stuffstuff-li">
  <a href="/stuff/stuff/" title="other stuff" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-stuffstuff"><span class="">Other stuff</span></a>
</li>
  </ul>
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            <div class="td-page-meta ms-2 pb-1 pt-2 mb-0">

</div>

            <div class="td-toc">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#ash---active-session-history">ASH - Active Session History</a>
      <ul>
        <li><a href="#useful-tables-and-views">Useful Tables and Views</a></li>
      </ul>
    </li>
    <li><a href="#ash-basics">ASH Basics</a>
      <ul>
        <li><a href="#description-of-the-fields">Description of the fields</a></li>
        <li><a href="#checking-available-ash-data">Checking available ASH data</a></li>
        <li><a href="#saving-ash-data">Saving ASH data</a></li>
      </ul>
    </li>
    <li><a href="#how-to-write-ash-scripts">How to write ASH scripts</a>
      <ul>
        <li><a href="#basic-script">Basic Script</a></li>
      </ul>
    </li>
    <li><a href="#drilldown">Drilldown</a>
      <ul>
        <li><a href="#finding-blocking-sessions">Finding blocking sessions</a></li>
        <li><a href="#tracing-a-specific-query">Tracing a specific query</a></li>
        <li><a href="#plsql-queries">PL/SQL queries</a></li>
        <li><a href="#viewing-specific-events">Viewing specific events</a></li>
        <li><a href="#other-useful-filters">Other useful filters</a></li>
      </ul>
    </li>
    <li><a href="#more-ash-queries">More ASH queries</a>
      <ul>
        <li><a href="#track-pga-usage">Track PGA usage</a></li>
        <li><a href="#track-temp-usage">Track TEMP usage</a></li>
      </ul>
    </li>
    <li><a href="#making-sense-of-the-output">Making sense of the output</a>
      <ul>
        <li><a href="#wait-events">Wait events</a></li>
        <li><a href="#locks-and-blocking-sessions">Locks and blocking sessions</a></li>
      </ul>
    </li>
    <li><a href="#common-waits-and-what-to-do-about-them">Common waits and what to do about them</a></li>
    <li><a href="#make-your-life-easier">Make your life easier</a></li>
  </ul>
</nav>
      </div>
    
            

          </aside>
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="td-breadcrumbs">
  <ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="/oracle/">Oracle</a></li>
  <li class="breadcrumb-item active" aria-current="page">
    active session history</li>
  </ol>
</nav>
<div class="td-content">
	<h1>active session history</h1>
	<div class="lead">Oracle&rsquo;s active session history demystified</div>
	<header class="article-meta">
		
<p class="reading-time"><i class="fa-solid fa-clock" aria-hidden="true"></i>&nbsp; 15 minute read &nbsp;</p>
</header>
	<h2 id="ash---active-session-history">ASH - Active Session History</h2>
<img src="/oracle/ash.jpg" alt="active_session_history" width="25%" height="25%"/>
<p>The view <strong>gv$active_session_history</strong> (ASH) records in memory every second the wait events of all active sessions. It is the single most important source of information for deep performance analysis on a session or even query level, like what a session was doing in a particular moment in time, what queries it was executing or which other sessions were blocking it. For all the data it contains it is surprisingly easy to use. First I will explain how the ASH works and what fields it provides, then I show you a basic script and how to extend it with all sorts of queries to get the info that you need.</p>
<p>Since the memory for ASH is limited, the data is only available for a few days or even hours. It is also usually gone when the instance was restarted, therefore, every 10 seconds a snapshot of the ASH data is stored permanently on disk and can be accessed through the view <strong>dba_hist_active_sess_history</strong> (DASH). The live view (Top activity) of Enterprise Manager is based on ASH data, AWR reports are based on <strong>dba_hist_</strong>* views.</p>
<h3 id="useful-tables-and-views">Useful Tables and Views</h3>
<p>To fully leverage all the information that the ASH provides, it helps to know some other useful views related to performance analysis.</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Name</th>
          <th style="text-align: left">Data Description</th>
          <th style="text-align: left">Notes</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">v$active_session_history</td>
          <td style="text-align: left">Wait events for all sessions of a node in 1-second snapshots</td>
          <td style="text-align: left">In memory, limited space</td>
      </tr>
      <tr>
          <td style="text-align: left">gv$active_session_history</td>
          <td style="text-align: left">Same as above, but for all nodes in a RAC cluster</td>
          <td style="text-align: left">Has additional column &ldquo;INST_ID&rdquo;</td>
      </tr>
      <tr>
          <td style="text-align: left">dba_hist_active_sess_history</td>
          <td style="text-align: left">Historical 10-second snapshots of ASH</td>
          <td style="text-align: left">Stored on disk; &ldquo;INSTANCE_NUMBER&rdquo; instead of &ldquo;INST_ID&rdquo;</td>
      </tr>
      <tr>
          <td style="text-align: left">v$ash_info</td>
          <td style="text-align: left">Statistics about ASH itself</td>
          <td style="text-align: left">&ldquo;OLDEST_SAMPLE_TIME&rdquo; shows how far back data goes</td>
      </tr>
      <tr>
          <td style="text-align: left">v$sql</td>
          <td style="text-align: left">Stats for currently loaded SQL statements</td>
          <td style="text-align: left">One row per child cursor</td>
      </tr>
      <tr>
          <td style="text-align: left">dba_hist_sqltext</td>
          <td style="text-align: left">Historical SQL text for SQL_IDs no longer in shared area</td>
          <td style="text-align: left">Use <code>set long 10000</code> to see full text</td>
      </tr>
      <tr>
          <td style="text-align: left">dba_objects</td>
          <td style="text-align: left">Info on all objects in the DB</td>
          <td style="text-align: left">Useful for mapping to current_obj# in ASH</td>
      </tr>
      <tr>
          <td style="text-align: left">dba_data_files</td>
          <td style="text-align: left">Info on all data files</td>
          <td style="text-align: left">Useful for mapping to current_file# in ASH</td>
      </tr>
  </tbody>
</table>
<h2 id="ash-basics">ASH Basics</h2>
<p>All ASH/DASH data is stored at the CDB level and can be accessed either from the CDB or a specific PDB. However, when you want to map the USER_ID, CURRENT_OBJ#, CURRENT_FILE# etc to names stored in dba_views, it&rsquo;s best to query ASH from within the corresponding PDB.</p>
<p>A word about gv$active_session_history vs. v$active_session_history: While they are defacto the same on a non-RAC database, on a RAC database the v$ variant only shows sessions running on one instance, whereas gv$ shows all sessions an all instances of the database. I therefore made it a habbit to always use gv$active_session_history and include the inst_id in my queries. The same is true for many other v$ views, in RAC there&rsquo;s usually a gv$ variant (like gv$session).</p>
<p>Note that the dba_hist views are always cluster wide and store the data for all instances.</p>
<h3 id="description-of-the-fields">Description of the fields</h3>
<p>ASH and DASH have over 100 fields, and more are added with each release. The description of all fields is available here:
<a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/refrn/DBA_HIST_ACTIVE_SESS_HISTORY.html">https://docs.oracle.com/en/database/oracle/oracle-database/19/refrn/DBA_HIST_ACTIVE_SESS_HISTORY.html</a></p>
<h4 id="useful-fields">Useful Fields</h4>
<p>All fields of ASH/DASH can be useful in specific cases, but the following are the most commonly used:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Column</th>
          <th style="text-align: left">Datatype</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">INST_ID</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">Only in gv$active_session_history, RAC instance where the session is running</td>
      </tr>
      <tr>
          <td style="text-align: left">INSTANCE_NUMBER</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">Only in dba_hist_active_sess_history, RAC instance where the session is running</td>
      </tr>
      <tr>
          <td style="text-align: left">SAMPLE_ID</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">ID of the sample</td>
      </tr>
      <tr>
          <td style="text-align: left">SAMPLE_TIME</td>
          <td style="text-align: left">TIMESTAMP(3)</td>
          <td style="text-align: left">Time at which the sample was taken</td>
      </tr>
      <tr>
          <td style="text-align: left">SESSION_ID</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">Session identifier; maps to V$SESSION.SID</td>
      </tr>
      <tr>
          <td style="text-align: left">SESSION_SERIAL#</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">Session serial number (uniquely identifies a session&rsquo;s objects); maps to V$SESSION.SERIAL#</td>
      </tr>
      <tr>
          <td style="text-align: left">SESSION_TYPE</td>
          <td style="text-align: left">VARCHAR2(10)</td>
          <td style="text-align: left">Session type: FOREGROUND/BACKGROUND</td>
      </tr>
      <tr>
          <td style="text-align: left">USER_ID</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">Oracle user identifier; maps to V$SESSION.USER#</td>
      </tr>
      <tr>
          <td style="text-align: left">SQL_ID</td>
          <td style="text-align: left">VARCHAR2(13)</td>
          <td style="text-align: left">SQL identifier of the SQL statement executed at the time of sampling</td>
      </tr>
      <tr>
          <td style="text-align: left">SQL_OPNAME</td>
          <td style="text-align: left">VARCHAR2(64)</td>
          <td style="text-align: left">SQL command name (INSERT, DELETE, UPDATE, etc.)</td>
      </tr>
      <tr>
          <td style="text-align: left">TOP_LEVEL_SQL_ID</td>
          <td style="text-align: left">VARCHAR2(13)</td>
          <td style="text-align: left">SQL identifier of the top-level SQL statement (for PL/SQL)</td>
      </tr>
      <tr>
          <td style="text-align: left">SQL_PLAN_HASH_VALUE</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">Numeric representation of the SQL plan for the cursor</td>
      </tr>
      <tr>
          <td style="text-align: left">EVENT</td>
          <td style="text-align: left">VARCHAR2(64)</td>
          <td style="text-align: left">If SESSION_STATE = WAITING, the event waited for; if ON CPU, this column is NULL</td>
      </tr>
      <tr>
          <td style="text-align: left">P1TEXT</td>
          <td style="text-align: left">VARCHAR2(64)</td>
          <td style="text-align: left">Text of the first additional parameter</td>
      </tr>
      <tr>
          <td style="text-align: left">P1</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">First additional parameter</td>
      </tr>
      <tr>
          <td style="text-align: left">P2TEXT</td>
          <td style="text-align: left">VARCHAR2(64)</td>
          <td style="text-align: left">Text of the second additional parameter</td>
      </tr>
      <tr>
          <td style="text-align: left">P2</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">Second additional parameter</td>
      </tr>
      <tr>
          <td style="text-align: left">P3TEXT</td>
          <td style="text-align: left">VARCHAR2(64)</td>
          <td style="text-align: left">Text of the third additional parameter</td>
      </tr>
      <tr>
          <td style="text-align: left">P3</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">Third additional parameter</td>
      </tr>
      <tr>
          <td style="text-align: left">WAIT_CLASS</td>
          <td style="text-align: left">VARCHAR2(64)</td>
          <td style="text-align: left">Wait class name of the event</td>
      </tr>
      <tr>
          <td style="text-align: left">SESSION_STATE</td>
          <td style="text-align: left">VARCHAR2(7)</td>
          <td style="text-align: left">Session state: WAITING / ON CPU</td>
      </tr>
      <tr>
          <td style="text-align: left">TIME_WAITED</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">If WAITING, time spent waiting for that event (in microseconds)</td>
      </tr>
      <tr>
          <td style="text-align: left">BLOCKING_SESSION</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">Session ID of the blocking session</td>
      </tr>
      <tr>
          <td style="text-align: left">BLOCKING_INST_ID</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">Instance number of the blocker</td>
      </tr>
      <tr>
          <td style="text-align: left">CURRENT_OBJ#</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">Object ID referenced</td>
      </tr>
      <tr>
          <td style="text-align: left">CURRENT_FILE#</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">File number referenced</td>
      </tr>
      <tr>
          <td style="text-align: left">CURRENT_BLOCK#</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">Block ID referenced</td>
      </tr>
      <tr>
          <td style="text-align: left">REMOTE_INSTANCE#</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">Remote instance serving the block</td>
      </tr>
      <tr>
          <td style="text-align: left">PGA_ALLOCATED</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">PGA memory used (in bytes)</td>
      </tr>
      <tr>
          <td style="text-align: left">TEMP_SPACE_ALLOCATED</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">TEMP memory used (in bytes)</td>
      </tr>
      <tr>
          <td style="text-align: left">CON_DBID</td>
          <td style="text-align: left">NUMBER</td>
          <td style="text-align: left">Database ID of the pluggable database (PDB)</td>
      </tr>
      <tr>
          <td style="text-align: left">PROGRAM</td>
          <td style="text-align: left">VARCHAR2(48)</td>
          <td style="text-align: left">Name of the operating system program</td>
      </tr>
      <tr>
          <td style="text-align: left">MACHINE</td>
          <td style="text-align: left">VARCHAR2(64)</td>
          <td style="text-align: left">Client&rsquo;s operating system machine name</td>
      </tr>
  </tbody>
</table>
<p><strong>Good to Know:</strong></p>
<ul>
<li>Wait events that only affect the CDB, such as backup activities, are not shown when querying ASH in the PDB.</li>
<li>A session in the PDB can have a blocking session from the CDB, e.g., the logwriter session. The wait events of the blocking session itself must then be analyzed via the CDB.</li>
</ul>
<h3 id="checking-available-ash-data">Checking available ASH data</h3>
<p>Before analyzing a problem in the ASH, you should ensure that the data for the relevant period is still available:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">oldest_sample_time</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">gv$ash_info</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- output
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">OLDEST_SAMPLE_TIME</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">03</span><span class="o">-</span><span class="n">SEP</span><span class="o">-</span><span class="mi">21</span><span class="w"> </span><span class="mi">03</span><span class="p">.</span><span class="mi">34</span><span class="p">.</span><span class="mi">03</span><span class="p">.</span><span class="mi">575000000</span><span class="w"> </span><span class="n">AM</span><span class="w">
</span></span></span></code></pre></div><p>Query information before &ldquo;OLDEST_SAMPLE_TIME&rdquo; can only be viewed via DASH.</p>
<h3 id="saving-ash-data">Saving ASH data</h3>
<p>If you want to analyze the problem later, it is advisable to save the entire ASH to a table to not lose the data in it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">ash_snapshot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">gv$active_session_history</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>In scripts, you should then select from this table instead:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- from gv$active_session_history
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">from</span><span class="w"> </span><span class="n">ash_snapshot</span><span class="w">
</span></span></span></code></pre></div><p><strong>Good to Know:</strong>
Queries that are no longer in ASH and ran less than 10 seconds may not appear in DASH either. In such cases, the waits of a query can no longer be meaningfully analyzed.</p>
<h2 id="how-to-write-ash-scripts">How to write ASH scripts</h2>
<p>As you will shortly see, it&rsquo;s very easy to start with a basic script to get an overview and then drill deeper to find the root cause of a particular problem. Even when you use scripts like Tanel Poder&rsquo;s &ldquo;ashtop&rdquo; it&rsquo;s good to have a basic understanding of how to query the ASH and get the maximum out of those scripts. I&rsquo;ll also show the difference between queries from ASH or DASH.</p>
<h3 id="basic-script">Basic Script</h3>
<p>Let&rsquo;s start with a basic query which will be the blueprint for our more complex queries. It returns the most important columns of all wait events in the last hour for all nodes of a RAC database and works in both CDB and PDB.</p>
<p><strong>Important</strong>: The &ldquo;TIME_WAITED&rdquo; column shows 0 for as long as the session was waiting for that particular event to end. When ordered by sample_time, the first non-zero value for a unique combination of inst_id/session_id/sql_id shows the total amount of time (in ms) the session had to wait on that event. When the &ldquo;TIME_WAITED&rdquo; and &ldquo;EVENT&rdquo; column are NULL (not 0), the session was on the CPU and not waiting for an event. You can select the session_state in your query if you want to confirm this.</p>
<h4 id="query-from-ash">Query from ASH</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">set</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="mi">400</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">set</span><span class="w"> </span><span class="n">pages</span><span class="w"> </span><span class="mi">100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">column</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">a22</span><span class="w"> </span><span class="n">tru</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">column</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">a30</span><span class="w"> </span><span class="n">tru</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="n">sample_time</span><span class="p">,</span><span class="w"> </span><span class="n">inst_id</span><span class="p">,</span><span class="w"> </span><span class="n">sql_id</span><span class="p">,</span><span class="w"> </span><span class="n">session_id</span><span class="p">,</span><span class="w"> </span><span class="n">user_id</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="p">,</span><span class="w"> </span><span class="n">time_waited</span><span class="p">,</span><span class="w"> </span><span class="n">current_obj</span><span class="o">#</span><span class="p">,</span><span class="w"> </span><span class="n">blocking_session</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">gv$active_session_history</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="n">sysdate</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">sysdate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">sample_time</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h4 id="query-from-dash">Query from DASH</h4>
<p>Difference from the ASH version:</p>
<ul>
<li>instance_number instead of inst_id</li>
<li>dba_hist_active_sess_history instead of gv$active_session_history</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">set</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="mi">400</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">set</span><span class="w"> </span><span class="n">pages</span><span class="w"> </span><span class="mi">100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">column</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">a22</span><span class="w"> </span><span class="n">tru</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">column</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">a30</span><span class="w"> </span><span class="n">tru</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="n">sample_time</span><span class="p">,</span><span class="w"> </span><span class="n">instance_number</span><span class="p">,</span><span class="w"> </span><span class="n">sql_id</span><span class="p">,</span><span class="w"> </span><span class="n">session_id</span><span class="p">,</span><span class="w"> </span><span class="n">user_id</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="p">,</span><span class="w"> </span><span class="n">time_waited</span><span class="p">,</span><span class="w"> </span><span class="n">current_obj</span><span class="o">#</span><span class="p">,</span><span class="w"> </span><span class="n">blocking_session</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">dba_hist_active_sess_history</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="n">sysdate</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">sysdate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">sample_time</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p><strong>Sample Output:</strong></p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">SAMPLE_TIME</th>
          <th style="text-align: left">INST_ID</th>
          <th style="text-align: left">SQL_ID</th>
          <th style="text-align: left">SESSION_ID</th>
          <th style="text-align: left">USER_ID</th>
          <th style="text-align: left">EVENT</th>
          <th style="text-align: left">TIME_WAITED</th>
          <th style="text-align: left">CURRENT_OBJ#</th>
          <th style="text-align: left">BLOCKING_SESSION</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">08-JUL-25 03.40.44.241</td>
          <td style="text-align: left">1</td>
          <td style="text-align: left">b913hx8hf360t</td>
          <td style="text-align: left">5059</td>
          <td style="text-align: left">89</td>
          <td style="text-align: left">direct path read</td>
          <td style="text-align: left">3764</td>
          <td style="text-align: left">45305959</td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">08-JUL-25 03.41.07.142</td>
          <td style="text-align: left">2</td>
          <td style="text-align: left">di8yqa8tfsgqu</td>
          <td style="text-align: left">2312</td>
          <td style="text-align: left">89</td>
          <td style="text-align: left">cursor: pin S wait on X</td>
          <td style="text-align: left">234920</td>
          <td style="text-align: left">4463384</td>
          <td style="text-align: left">4801</td>
      </tr>
      <tr>
          <td style="text-align: left">08-JUL-25 03.41.07.142</td>
          <td style="text-align: left">2</td>
          <td style="text-align: left">cy6kjxcbcz8p3</td>
          <td style="text-align: left">893</td>
          <td style="text-align: left">89</td>
          <td style="text-align: left">db file parallel read</td>
          <td style="text-align: left">3275</td>
          <td style="text-align: left">48367311</td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">08-JUL-25 03.41.07.142</td>
          <td style="text-align: left">2</td>
          <td style="text-align: left">di8yqa8tfsgqu</td>
          <td style="text-align: left">17769</td>
          <td style="text-align: left">89</td>
          <td style="text-align: left">cursor: pin S wait on X</td>
          <td style="text-align: left">274117</td>
          <td style="text-align: left">4463382</td>
          <td style="text-align: left">4801</td>
      </tr>
  </tbody>
</table>
<h4 id="mapping-to-user-and-object-name">Mapping to User and Object Name</h4>
<p>The user and object names can be joined to have names instead of ids, but only in the PDB:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">set</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="mi">400</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">set</span><span class="w"> </span><span class="n">pages</span><span class="w"> </span><span class="mi">100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">column</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">a22</span><span class="w"> </span><span class="n">tru</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">column</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">a30</span><span class="w"> </span><span class="n">tru</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">column</span><span class="w"> </span><span class="n">object_name</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">a30</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="n">sample_time</span><span class="p">,</span><span class="w"> </span><span class="n">inst_id</span><span class="p">,</span><span class="w"> </span><span class="n">sql_id</span><span class="p">,</span><span class="w"> </span><span class="n">session_id</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="p">,</span><span class="w"> </span><span class="n">time_waited</span><span class="p">,</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">object_name</span><span class="p">,</span><span class="w"> </span><span class="n">blocking_session</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">gv$active_session_history</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">join</span><span class="w"> </span><span class="n">dba_users</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">user_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">user_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">join</span><span class="w"> </span><span class="n">dba_objects</span><span class="w"> </span><span class="k">c</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">current_obj</span><span class="o">#</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">object_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="n">sysdate</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">sysdate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p><strong>Sample Output:</strong></p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">SAMPLE_TIME</th>
          <th style="text-align: left">INST_ID</th>
          <th style="text-align: left">SQL_ID</th>
          <th style="text-align: left">SESSION_ID</th>
          <th style="text-align: left">USERNAME</th>
          <th style="text-align: left">EVENT</th>
          <th style="text-align: left">TIME_WAITED</th>
          <th style="text-align: left">OBJECT_NAME</th>
          <th style="text-align: left">BLOCKING_SESSION</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">08-JUL-25 03.40.54.854</td>
          <td style="text-align: left">2</td>
          <td style="text-align: left">84p8c9j3ctpua</td>
          <td style="text-align: left">14553</td>
          <td style="text-align: left">RAPHI_USER</td>
          <td style="text-align: left">cursor: pin S wait on X</td>
          <td style="text-align: left">1191291</td>
          <td style="text-align: left">TRACKING_TABLE</td>
          <td style="text-align: left">11326</td>
      </tr>
      <tr>
          <td style="text-align: left">08-JUL-25 03.40.54.854</td>
          <td style="text-align: left">2</td>
          <td style="text-align: left">84p8c9j3ctpua</td>
          <td style="text-align: left">9272</td>
          <td style="text-align: left">RAPHI_USER</td>
          <td style="text-align: left">cursor: pin S wait on X</td>
          <td style="text-align: left">1206884</td>
          <td style="text-align: left">TRK_PK_IDX</td>
          <td style="text-align: left">11326</td>
      </tr>
      <tr>
          <td style="text-align: left">08-JUL-25 03.42.08.156</td>
          <td style="text-align: left">3</td>
          <td style="text-align: left">cxfgr5c2j9zgg</td>
          <td style="text-align: left">7578</td>
          <td style="text-align: left">RAPHI_USER</td>
          <td style="text-align: left">row cache lock</td>
          <td style="text-align: left">5642933</td>
          <td style="text-align: left">SUB_PART_MGR</td>
          <td style="text-align: left">4975</td>
      </tr>
      <tr>
          <td style="text-align: left">08-JUL-25 03.42.08.156</td>
          <td style="text-align: left">3</td>
          <td style="text-align: left">bz77a36407aty</td>
          <td style="text-align: left">4622</td>
          <td style="text-align: left">RAPHI_USER</td>
          <td style="text-align: left">row cache lock</td>
          <td style="text-align: left">5650066</td>
          <td style="text-align: left">SUB_PART_MGR</td>
          <td style="text-align: left">4975</td>
      </tr>
  </tbody>
</table>
<p>Now we are getting somewhere, we see the username and which objects where affected by the wait clearly.</p>
<h4 id="limiting-the-time-range">Limiting the time range</h4>
<p>The &ldquo;sample_time&rdquo; column can be used to limit the query period, allowing you to focus on the relevant part. This can be done relative to sysdate:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">where</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="n">sysdate</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">sysdate</span><span class="w">
</span></span></span></code></pre></div><p>or as a specific time range:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">where</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;25-Nov-2020 00:40:00&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;DD-Mon-YYYY HH24:MI:SS&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;25-Nov-2020 00:50:00&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;DD-Mon-YYYY HH24:MI:SS&#39;</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></div><p>or both combined:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">where</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;25-Nov-2020 00:40:00&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;DD-Mon-YYYY HH24:MI:SS&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">sysdate</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h4 id="limiting-the-number-of-rows">Limiting the number of rows</h4>
<p>In one hour, ASH can record a huge number of rows, but often only the last 100 are of interest. To focus only on them, reverse the sort order and limit the output with fetch:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">where</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="n">sysdate</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">sysdate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="k">desc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fetch</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="k">only</span><span class="w">
</span></span></span></code></pre></div><h2 id="drilldown">Drilldown</h2>
<p>With the basic script, you can get an overview of what was happening in the database during the selected period. The script can then be extended as needed to further narrow down the problem.</p>
<h3 id="finding-blocking-sessions">Finding blocking sessions</h3>
<p>If, for example, a blocking_session is responsible for many waits, you can look at this session in more detail  the number in the &ldquo;blocking_session&rdquo; column is the session_id of the blocking session:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">where</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="n">sysdate</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">sysdate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">session_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">123456</span><span class="w">
</span></span></span></code></pre></div><h3 id="tracing-a-specific-query">Tracing a specific query</h3>
<p>Similarly, if you want to look at a specific query, just filter by sql_id:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">where</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="n">sysdate</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">sysdate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">sql_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1ps650r41s7qr&#39;</span><span class="w">
</span></span></span></code></pre></div><h3 id="plsql-queries">PL/SQL queries</h3>
<p>In Oracle Enterprise Manager, you often only see the SQL_ID of the PL/SQL procedure among the top sessions. If you want to view all associated queries, filter by top_level_sql_id and specify the PL/SQL sql_id:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">where</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="n">sysdate</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">sysdate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">top_level_sql_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1ps650r41s7qr&#39;</span><span class="w">
</span></span></span></code></pre></div><h3 id="viewing-specific-events">Viewing specific events</h3>
<p>You can easily identify sessions affected by a specific wait using the Event column. A list of all possible wait events can be obtained with this query:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">wait_class</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">V$EVENT_NAME</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>Alternatively, you can list only the waits that actually occur in ASH:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">gv$active_session_history</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>To filter for specific event types, extend the basic query, for example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">where</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="n">sysdate</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">sysdate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- pick one of these:
</span></span></span><span class="line"><span class="cl"><span class="c1">-- index contention
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">and</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;enq: TX - index contention&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- all transaction contentions
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">and</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;enq: TX%&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- read/write operations
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">event</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;db file%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;direct path%&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- all cluster waits (full RAC)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">and</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;gc%&#39;</span><span class="w">
</span></span></span></code></pre></div><h3 id="other-useful-filters">Other useful filters</h3>
<ul>
<li>Waits over 1 second:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">and</span><span class="w"> </span><span class="n">time_waited</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1000000</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>Sessions accessing a specific object:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">and</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">object_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;NAME_OF_OBJECT&#39;</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>Sessions accessing a specific file:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">and</span><span class="w"> </span><span class="n">current_file</span><span class="o">#</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">134</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>Sessions accessing the same block in the same file (e.g., in case of contention):</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">and</span><span class="w"> </span><span class="n">current_file</span><span class="o">#</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">134</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">current_block</span><span class="o">#</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">123456</span><span class="w">
</span></span></span></code></pre></div><h2 id="more-ash-queries">More ASH queries</h2>
<p>Some other ASH queries which are not directly developed from the basic script above but can also be useful.</p>
<h3 id="track-pga-usage">Track PGA usage</h3>
<p>With this query, you can check how much PGA each session_id has used:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">inst_id</span><span class="p">,</span><span class="w"> </span><span class="n">session_id</span><span class="p">,</span><span class="w"> </span><span class="n">session_serial</span><span class="o">#</span><span class="p">,</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="n">pga_allocated</span><span class="p">)</span><span class="o">/</span><span class="mi">1024</span><span class="o">/</span><span class="mi">1024</span><span class="o">/</span><span class="mi">1024</span><span class="w"> </span><span class="n">GB</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">gv$active_session_history</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="n">sysdate</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">sysdate</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">inst_id</span><span class="p">,</span><span class="n">session_id</span><span class="p">,</span><span class="w"> </span><span class="n">session_serial</span><span class="o">#</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="track-temp-usage">Track TEMP usage</h3>
<p>Similarly, you can find the sessions that have used the most TEMP:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">inst_id</span><span class="p">,</span><span class="w"> </span><span class="n">session_id</span><span class="p">,</span><span class="w"> </span><span class="n">session_serial</span><span class="o">#</span><span class="p">,</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="n">temp_space_allocated</span><span class="p">)</span><span class="o">/</span><span class="mi">1024</span><span class="o">/</span><span class="mi">1024</span><span class="o">/</span><span class="mi">1024</span><span class="w"> </span><span class="n">GB</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">gv$active_session_history</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="n">sysdate</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">sysdate</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">inst_id</span><span class="p">,</span><span class="w"> </span><span class="n">session_id</span><span class="p">,</span><span class="w"> </span><span class="n">session_serial</span><span class="o">#</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h2 id="making-sense-of-the-output">Making sense of the output</h2>
<p>Now that we know how to query the ASH it&rsquo;s time to speak about what to do with the information.</p>
<h3 id="wait-events">Wait events</h3>
<p>This is the true bread and butter of the ASH. Understanding wait events, why they occur, what impact they have, how to correlate them and ultimately how to solve them is what makes performance tuning an art form rather than a scientific method. I can not go into the details of every important wait event because most would warrant a dedicated blog post of it&rsquo;s own. However, the official Oracle documentation has a brief description of all wait events:</p>
<p><a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/refrn/descriptions-of-wait-events.html">https://docs.oracle.com/en/database/oracle/oracle-database/19/refrn/descriptions-of-wait-events.html</a></p>
<p>A good way to start when someone tells you that the database was slow, without any particulars like a sql_id or session_id, is to look for any events with a time_waited higher than a second. If one wait event stands out, check the documentation or google it. AI like perplexity.ai are also very good at explaining certain wait events, but it helps if you have at least some understanding because especially with everything Oracle, AI tends to blatantly lie to your face (apparently because the Oracle documentation is unclear, as perplexity explained to me :D).</p>
<h4 id="event-parameters">Event Parameters</h4>
<p>When searching for wait events, it&rsquo;s often useful to select the &ldquo;P1&rdquo; column (and possibly P2, P3). These provide additional information about the wait event, e.g. for Row Cache Locks, which DC Cache was involved. The columns &ldquo;P1TEXT&rdquo; (and P2TEXT, P3TEXT) give a descriptive name to the value. To see what the individual P-values mean, you can look at v$event_name:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">set</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="mi">400</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">col</span><span class="w"> </span><span class="n">parameter1</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">a20</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">col</span><span class="w"> </span><span class="n">parameter2</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">a20</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">col</span><span class="w"> </span><span class="n">parameter3</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">a20</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parameter1</span><span class="p">,</span><span class="w"> </span><span class="n">parameter2</span><span class="p">,</span><span class="w"> </span><span class="n">parameter3</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">V$EVENT_NAME</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;row%lock&#39;</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p><strong>Sample Output:</strong></p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">NAME</th>
          <th style="text-align: left">PARAMETER1</th>
          <th style="text-align: left">PARAMETER2</th>
          <th style="text-align: left">PARAMETER3</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">row cache lock</td>
          <td style="text-align: left">cache id</td>
          <td style="text-align: left">mode</td>
          <td style="text-align: left">request</td>
      </tr>
  </tbody>
</table>
<p>You can then extend the basic query accordingly:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">set</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="mi">400</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">set</span><span class="w"> </span><span class="n">pages</span><span class="w"> </span><span class="mi">100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">column</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">a22</span><span class="w"> </span><span class="n">tru</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">column</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">a30</span><span class="w"> </span><span class="n">tru</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="n">sample_time</span><span class="p">,</span><span class="w"> </span><span class="n">inst_id</span><span class="p">,</span><span class="w"> </span><span class="n">sql_id</span><span class="p">,</span><span class="w"> </span><span class="n">session_id</span><span class="p">,</span><span class="w"> </span><span class="n">user_id</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="p">,</span><span class="w"> </span><span class="n">p1text</span><span class="p">,</span><span class="w"> </span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">time_waited</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">gv$active_session_history</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">sample_time</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="n">sysdate</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">sysdate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;row%lock&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="locks-and-blocking-sessions">Locks and blocking sessions</h3>
<p>One of the most common reason for a sudden performance loss is the application itself accessing the database. This can have a very <del>stupid</del>simple cause, like someone manually executed a query that was updating a column of all rows in a table while the application was running, resulting in tons of row locks.</p>
<p>Other less obvious causes are normal application sessions running slower than usual, causing locks and blocking other sessions. Possible causes from my own experience:</p>
<ul>
<li>execution plan of a query has suddenly changed for whatever reason, like missing statistics or different bind values</li>
<li>a network problem between the application and DB server</li>
<li>a network problem in a dataguard environment with MaxProtection between primary and standby</li>
<li>accessing the same table on different instances in a RAC database, causing a lot of block shipping</li>
<li>not enough SGA to handle increased application volume, resulting in more blocks read from disk</li>
<li>not enough PGA to handle complex queries, resulting in more temp usage</li>
<li>Oracle changing the default for the parameter db_lost_write_protection in 19.26c (this caused us real headache)</li>
<li>and many more</li>
</ul>
<p>Not all of these issues can be resolved with ASH alone but you most likely will find out where to look. For example, if you see a blocking session appearing in many other sessions, check what that session was doing:</p>
<ul>
<li>what queries was it running</li>
<li>what objects was it accessing</li>
<li>what wait events did it spend the most time on</li>
<li>was it also blocked by yet another session</li>
</ul>
<p>The examples in the drill down section above should help you closing in on the source of the problem.</p>
<h2 id="common-waits-and-what-to-do-about-them">Common waits and what to do about them</h2>
<p>This is an attempt of a cookie-cutter guide for some of the more common wait events.</p>
<table><tr><th>Symptom</th><th>Reasons</th><th>Actions</th></tr>
<tr><td><ul><li>Many logfile sync events with high time_waited (> 1000000)</li></ul></td>
<td><ul><li>overload of the database, too many sessions</li>
<li>network issues in dataguard</li>
<li>SAN/storage problems</li>
<li>high CPU usage</li></ul></td>
<td><ul><li>Check average active sessions are lower than nr of cpu cores</li>
<li>Check alert.log for many logswitches or remote sync timeouts</li>
<li>Check /var/log/messages and cluster logs (if using grid) for any link down errors</li>
<li>Check if SAN and network load is below it's limits</li>
<li>Check host cpu usage with "top" or "sar"</li></ul>
<tr><td><ul><li>High amount of enq: xxx  or lock wait events</li></ul></td>
<td><ul><li>Contention of some sorts:</li>
<li>enq: TX - transaction related (locks on same object)</li>
<li>enq: SN/SQ - sequences related </li>
<li>enq: IV or L[A-P] - library cache related</li>
<li>row cache lock - DDL related</li></ul></td>
<td><ul><li>Check for blocking sessions and current_obj#</li>
<li>Increase the sequence cache</li>
<li>Check for too many parses or parallel sessions - or bugs</li>
<li>Check for DDL on current_obj#, can also occur when a segment is being extended or any other dictionary operation affecting an object</li></ul>
</td></tr>
<tr><td><ul><li>High amount of gc: xxx wait evens</li></ul></td>
<td><ul><li>RAC related, usually different instances accessing the same objects</li></ul></td>
<td><ul><li>Check for similar queries running on different "INST_ID"</li>
<li>Check for different "INST_ID" accessing the same current_obj#</li>
<li>Ensure that Jumbo Frames are enabled on the interconnect</li>
<li>Use instance bound services to separate the workload and table access</li></ul></td></tr>
</table>
<h2 id="make-your-life-easier">Make your life easier</h2>
<p>Now that you hopefully have a better understanding of how to work with the active session history, it&rsquo;s time to let you in on a secret: Tanel Poder&rsquo;s script &ldquo;ashtop.sql&rdquo; does all the heavy lifting for us and in most cases it is no longer needed to write a custom script ourselfs. The basic script in this post can replaced with this ashtop.sql query:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">@</span><span class="n">ashtop</span><span class="w"> </span><span class="n">inst_id</span><span class="p">,</span><span class="n">session_id</span><span class="p">,</span><span class="n">sql_id</span><span class="p">,</span><span class="k">user</span><span class="p">,</span><span class="n">objt</span><span class="p">,</span><span class="n">event2</span><span class="p">,</span><span class="n">time_waited</span><span class="p">,</span><span class="n">blocking_session</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">sysdate</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="n">sysdate</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>Or to just get an overview of the top queries:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">@</span><span class="n">ashtop</span><span class="w"> </span><span class="n">sql_id</span><span class="p">,</span><span class="n">event2</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">sysdate</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="n">sysdate</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>Bear in mind though that it only shows the top 15 queries, which makes it even more important that you know what to query and be as specific as you can.</p>
<p>I am a big fan of ashtop.sql and use it on a daily basis. I explain it in detail with more drill down examples here: <a href="/oracle/ashtop">/oracle/ashtop</a></p>

	
</div>


          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        
      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        
      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/js/main.js"></script>
<script defer src="/js/click-to-copy.js" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>